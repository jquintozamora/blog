<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Accept-CH" content="DPR, Viewport-Width, Width"><title>Compile, optimize and watch our LESS / CSS files with Gulp tasks using Visual Studio 2015 in our SharePoint Online solutions | José Quinto</title><meta name="description" content="Compile, optimize and watch our LESS / CSS files with Gulp tasks using Visual Studio 2015 in our SharePoint Online solutions"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover"><meta property="og:image" content="https://blog.josequinto.com/2016/05/20/compile-optimize-and-watch-our-less-css-files-with-gulp-tasks-using-visual-studio-2015-in-our-sharepoint-online-solutions/featured.png"><meta name="twitter:image" content="https://blog.josequinto.com/2016/05/20/compile-optimize-and-watch-our-less-css-files-with-gulp-tasks-using-visual-studio-2015-in-our-sharepoint-online-solutions/featured.png"><meta property="fb:app_id" content="155567495101835"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:url" content="https://blog.josequinto.com/2016/05/20/compile-optimize-and-watch-our-less-css-files-with-gulp-tasks-using-visual-studio-2015-in-our-sharepoint-online-solutions/" property="og:url"><meta name="twitter:title" content="Compile, optimize and watch our LESS / CSS files with Gulp tasks using Visual Studio 2015 in our SharePoint Online solutions | José Quinto" property="og:title"><meta name="twitter:site" content="@jquintozamora"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.josequinto.com/2016/05/20/compile-optimize-and-watch-our-less-css-files-with-gulp-tasks-using-visual-studio-2015-in-our-sharepoint-online-solutions/"><meta property="og:title" content="Compile, optimize and watch our LESS / CSS files with Gulp tasks using Visual Studio 2015 in our SharePoint Online solutions | José Quinto"><link rel="canonical" href="https://blog.josequinto.com/2016/05/20/compile-optimize-and-watch-our-less-css-files-with-gulp-tasks-using-visual-studio-2015-in-our-sharepoint-online-solutions/"><link rel="author" href="https://plus.google.com/u/0/108403117712061507579"><link rel="alternate" type="application/rss+xml" title="Jose Quinto" href="https://blog.josequinto.com/feed.rss"><meta name="theme-color" content="#ffffff"><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.1"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.js" defer></script><script>var GLOBAL = { 
  root: '/',
  algolia: {"appId":"C7MOFESP3V","apiKey":"cdc4a9b7af864c710f2d3da5caf59eec","indexName":"dev_JQBLOG","hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><div id="bodyWrapper"><div id="content-outer"><div id="top-container" style="background-image: url(/background.svg)"><div id="page-header"><span class="pull-left"> <a class="brand" href="/"><img class="brand-image" src="/jose-quinto.png"><div class="brand-name">José Quinto</div></a></span><i class="fa fa-share toggle-social" aria-hidden="true"></i><div class="socialicons" id="header-social-icons"><a class="social-icon" href="https://twitter.com/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-twitter"></i></a><a class="social-icon" href="https://github.com/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-github"></i></a><a class="social-icon" href="https://codepen.io/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-codepen"></i></a><a class="social-icon" href="https://www.linkedin.com/in/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-linkedin"></i></a><a class="social-icon" href="https://stackoverflow.com/users/5015774/jos%C3%A9-quinto-zamora?tab=profile" target="_blank" rel="noopener"><i class="fa fa-stack-overflow"></i></a><a class="social-icon" href="https://blog.josequinto.com/feed.rss" target="_blank" rel="noopener"><i class="fa fa-rss"></i></a></div><a class="social-icon search"><i class="fa fa-search"></i></a><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Search posts:</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/about.html">About</a></span></div><div id="post-info"><div id="post-title">Compile, optimize and watch our LESS / CSS files with Gulp tasks using Visual Studio 2015 in our SharePoint Online solutions</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2016-05-20</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/taxonomy/Article/">Article</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/taxonomy/Article/Architecture-Concept/">Architecture-Concept</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/taxonomy/Article/Architecture-Concept/Concept-Explained/">Concept-Explained</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/taxonomy/Article/Architecture-Concept/Concept-Explained/Download-Project/">Download-Project</a><span class="post-meta__separator">|</span><i class="fa fa-comment-o post-meta__icon" aria-hidden="true"></i><a href="/2016/05/20/compile-optimize-and-watch-our-less-css-files-with-gulp-tasks-using-visual-studio-2015-in-our-sharepoint-online-solutions/#disqus_thread"><span class="disqus-comment-count" data-disqus-identifier="2016/05/20/compile-optimize-and-watch-our-less-css-files-with-gulp-tasks-using-visual-studio-2015-in-our-sharepoint-online-solutions/"></span></a></div></div></div><div class="layout" id="content-inner"><section class="articlePostContainer"><nav class="sidebar-toc"><div class="sidebar-toc__title">Contents</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Old-approach"><span class="toc-number">2.</span> <span class="toc-text">Old approach</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Folder-Structure"><span class="toc-number">3.</span> <span class="toc-text">Folder Structure</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Configure-NPM-and-package-json"><span class="toc-number">4.</span> <span class="toc-text">Configure NPM and package.json</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What-is-Gulp"><span class="toc-number">5.</span> <span class="toc-text">What is Gulp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Create-Gulp-file-in-VS-2015"><span class="toc-number">6.</span> <span class="toc-text">Create Gulp file in VS 2015</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#General-concepts-of-Gulp"><span class="toc-number">6.1.</span> <span class="toc-text">General concepts of Gulp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Functions-and-3rd-party-plugins"><span class="toc-number">6.2.</span> <span class="toc-text">Functions and 3rd party plugins</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Create-Gulp-configuration-file-in-VS-2015"><span class="toc-number">7.</span> <span class="toc-text">Create Gulp configuration file in VS 2015</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-to-manage-gulp-tasks-using-Task-Runner-Explorer-in-VS-2015"><span class="toc-number">8.</span> <span class="toc-text">How to manage gulp tasks using Task Runner Explorer in VS 2015</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Run-css-optimize-task"><span class="toc-number">8.1.</span> <span class="toc-text">Run css-optimize task</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Run-css-upload-to-sharepoint-task"><span class="toc-number">8.2.</span> <span class="toc-text">Run css-upload-to-sharepoint task</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Run-watcher-less-task"><span class="toc-number">8.3.</span> <span class="toc-text">Run watcher-less task</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Include-Output-files-in-the-Project-module-and-Solution"><span class="toc-number">9.</span> <span class="toc-text">Include Output files in the Project, module and Solution</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Download-full-project"><span class="toc-number">10.</span> <span class="toc-text">Download full project</span></a></li></ol></div></nav><section class="postArticle"><article id="post"><div class="post-featuredImage"><img src="featured.png" width="auto" height="auto"></div><div id="post-content"><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>When we are working on <strong>SharePoint </strong>(or <strong>Office 365</strong>) projects, eventually you need to integrate custom <strong>CSS, HTML, JavaScript</strong> within SharePoint components. I remember my first projects with SharePoint 2007 where we coded server components with C# or VB and it were really hard to integrate custom CSS and JavaScript in our solutions. But since a time ago, developing custom components for SharePoint OnPrem or Online becomes increasingly standard, from the viewpoint of the Web Development standards.</p>
<p>Anyway, if we need to include custom CSS files in our solution. We can do it in several ways:</p>
<ul>
<li>Including CSS file with <strong>Custom Action</strong></li>
<li>Including CSS file in a <strong>custom Master Page</strong></li>
<li>Including CSS as an <strong>Alternate CSS</strong></li>
<li>And more…</li>
</ul>
<p>This article is not about what is the best way to include CSS in our projects, neither how to integrate themable CSS in our solutions, this article is about how to integrate <strong>LESS</strong>, <strong>Node.js</strong> and <strong>Gulp</strong> in our <strong>SharePoint Online Solutions</strong> using <strong>Visual Studio 2015.</strong></p>
<h2 id="Old-approach"><a href="#Old-approach" class="headerlink" title="Old approach"></a>Old approach</h2><p>Ordinarily, we create our <strong>LESS</strong> files and rely on <strong>Visual Studio Web Essentials</strong> to compile LESS files into the final CSS. There are couple of cons with this approach:</p>
<ol>
<li>If you have a LESS file that <strong>depends</strong> <strong>on other</strong>, you always need to save the last one, even if the changes were done in other. I mean, imagine we have Layouts.less and MasterPage.less. Inside <strong>MasterPage.less </strong>we have <strong>@import “Layouts.less”;</strong> so the final file (after compiling LESS) called MasterPage.css will be the combination of Layouts and MasterPage. Imagine you change some classes in Layout.less, and <strong>Web Essentials automatically compiles Layous.less file for you</strong>, but Web Essentials<strong> is not able to see the dependency of MasterPage and therefore MasterPage.less is not compiled automatically unless you open add some useless char and save it.</strong></li>
<li>You cannot configure Web Essentials to do some extra tasks after compiling, like <strong>CSS optimization, upload files to SharePoint,</strong> etc.</li>
</ol>
<p>One of the things I like of <strong>Gulp</strong> is that has been used for Web Developers a long time and you have a lot of free and good plugins. Because that, you can use <strong>Gulp tasks</strong> and modules to <strong>compile</strong>, <strong>optimize</strong> and <strong>upload to SharePoint</strong> the results of your LESS files, which is really good in terms of <strong>productivity</strong>. Note that if you use VS 2015, you will benefit from <strong>Task Runner Explorer</strong> (to manage <strong>Gulp</strong> <strong>directly in UI</strong>) and <strong>Node.js integration</strong>.</p>
<p>We will show a sort of starter template for LESS, Node.js and Gulp together to integrate in SharePoint projects. Let’s start with the Folder Structure and after that we will see step by step how to create all files.</p>
<h2 id="Folder-Structure"><a href="#Folder-Structure" class="headerlink" title="Folder Structure"></a>Folder Structure</h2><p>This is an example of Folders Structure in our SharePoint Project:</p>
<p><a href="./image-7.png"><img src="./image-7.png" alt="image" title="image"></a></p>
<p>Some note aside this folder structure:</p>
<ul>
<li>Note that this is a <strong>basic example</strong>, in a real SharePoint project there will be more folders, modules, features, etc.</li>
<li><p>There are 5 less files behind Styles/LESS folder:</p>
<ul>
<li><strong>JQ.Extensions.Foundation.less</strong> is the CSS provided by Foundation framework that helps us to provide responsive, multi columns layout, etc.</li>
<li><strong>JQ.Globals.less</strong> is where we define global variables</li>
<li><strong>JQ.MasterPage.less</strong> is the main file that will be included in our SharePoint pages.</li>
<li><strong>JQ.Responsive.less</strong> is a file used exclusively to create responsive classes. That will be imported in MasterPage.less.</li>
<li><strong>JQ.Themable.less</strong> is a file used for Themable CSS that will be integrated in SharePoint Theme Feature.</li>
<li><strong>JQ.Themable.Responsive.less</strong> is used for providing responsive styles and media queries for Themable CSS.</li>
<li>This is an example, I am pretty sure we will have in our projects more files like: Common, WebParts, …</li>
</ul>
</li>
<li><p><strong>Output</strong> folder used to store the result of compiling and optimizing LESS with Gulp tasks.</p>
</li>
<li><strong>Elements.xml</strong> where we will configure the files to be uploaded to SharePoint in the wsp package. In this case will be <strong>JQ.MasterPage.min.css </strong>and <strong>JQ.Themable.min.css</strong>.</li>
<li><strong>package.json</strong> to configure NPM tool and install our desired packages (luckily VS 2015 understands this format)</li>
<li><strong>gulpfile.js</strong> where will be created Gulp tasks (VS 2015 also reads this file and provide us UI interface to manage them called <strong>Task Runner Explorer</strong>).</li>
<li><strong>gulp.config.js</strong> is used by gulpfile.js to get all the configurations needed. (this is some kind of standard as you can see in the John Papa gulp patterns (<a href="https://github.com/johnpapa/gulp-patterns" target="_blank" rel="noopener">https://github.com/johnpapa/gulp-patterns</a>).
&nbsp;</li>
</ul>
<h2 id="Configure-NPM-and-package-json"><a href="#Configure-NPM-and-package-json" class="headerlink" title="Configure NPM and package.json"></a>Configure NPM and package.json</h2><p>VS 2015 automatically runs <strong>NPM</strong> every time we save changes in the <strong>package.json</strong> file located at the root folder of our project (SharePoint project as well).</p>
<p><strong>I highly recommend you <a href="/2016/05/04/how-to-configure-visual-studio-2015-integration-with-latest-version-of-node-js-and-npm">upgrade NPM version used by VS 2015</a></strong>.</p>
<p>Let’s see how to <strong>create a new package.json</strong> file in our project:</p>
<p>Right click on the project, Add New Item and Create a file called package.json (there is a template called NPM configuration file)</p>
<p><a href="./clip_image002-2.png"><img src="./clip_image002-2.png" alt="clip_image002" title="clip_image002"></a></p>
<p>This is how the template looks:</p>
<p><a href="./clip_image003.png"><img src="./clip_image003.png" alt="clip_image003" title="clip_image003"></a></p>
<p>Because this post is about how to compile, optimize and upload LESS these are the required packages to install as a devDependencies:</p>
<p>&nbsp;</p>
<script src="https://gist.github.com/jquintozamora/2228079ee4d1950a4de04c03e37b723a.js"></script>

<p><a href="./clip_image004.png"><img src="./clip_image004.png" alt="clip_image004" title="clip_image004"></a></p>
<p>Ofter you create and just when you save the package.json file, you can see in the <strong>Bower/npm console</strong> when you have the file package.json, how the packages are installed.</p>
<p><a href="./clip_image005.png"><img src="./clip_image005.png" alt="clip_image005" title="clip_image005"></a></p>
<p><a href="./clip_image006.png"><img src="./clip_image006.png" alt="clip_image006" title="clip_image006"></a></p>
<p><a href="./clip_image007.png"><img src="./clip_image007.png" alt="clip_image007" title="clip_image007"></a></p>
<p>Also, we will see a new folder called “<strong>node_modules</strong>“ in our project (check Show all files button in the <strong>Solution Explorer</strong>).</p>
<p><a href="./clip_image008.png"><img src="./clip_image008.png" alt="clip_image008" title="clip_image008"></a></p>
<p>You can also see the folder in the <strong>file system</strong>:</p>
<p><a href="./clip_image009.png"><img src="./clip_image009.png" alt="clip_image009" title="clip_image009"></a></p>
<p>Good stuff! Now, we have configured <strong>NPM integration with VS 2015</strong>!</p>
<p>Let’s see how to introduce Gulp in this scenario.</p>
<p>&nbsp;</p>
<h2 id="What-is-Gulp"><a href="#What-is-Gulp" class="headerlink" title="What is Gulp"></a>What is Gulp</h2><p>From gulp site (<a href="https://github.com/gulpjs/gulp" target="_blank" rel="noopener">https://github.com/gulpjs/gulp</a>):</p>
<blockquote>
<p>“gulp is a toolkit that helps you automate painful or time-consuming tasks in your development workflow.”</p>
</blockquote>
<p>In other words, <strong>Gulp is a task manager</strong>. I like it because it have <strong>tons of free plugins</strong> or <strong>NPM packages</strong> to integrate with. And because it is <strong>integrated in VS 2015 using the Task Runner Explorer</strong>:</p>
<p><a href="./clip_image010.png"><img src="./clip_image010.png" alt="clip_image010" title="clip_image010"></a></p>
<p>We will see later on this post how <strong>Task Runner Explorer</strong> works and how can <strong>we manage gulp tasks within it</strong>.</p>
<p>&nbsp;</p>
<h2 id="Create-Gulp-file-in-VS-2015"><a href="#Create-Gulp-file-in-VS-2015" class="headerlink" title="Create Gulp file in VS 2015"></a>Create Gulp file in VS 2015</h2><p>We already have <strong>Gulp</strong> installed because we installed via <strong>NPM and package.json file</strong>.</p>
<p>We are going to create a file called <strong>gulpfile.js</strong> at the root folder of the project</p>
<p>Right click on the project, Add new Item, type gulp in search box and you can see the template called “Gulp configuration file”.</p>
<p><a href="./clip_image011.png"><img src="./clip_image011.png" alt="clip_image011" title="clip_image011"></a></p>
<p><strong>gulpfile.js MUST be at root folder in the project:</strong></p>
<p><a href="./clip_image012.png"><img src="./clip_image012.png" alt="clip_image012" title="clip_image012"></a></p>
<p>This is how your first gulpfile.js file looks:</p>
<p><a href="./clip_image013.png"><img src="./clip_image013.png" alt="clip_image013" title="clip_image013"></a></p>
<p>If we use <strong>require(‘gulp’)</strong> in our gulpfile.js file, then the gulp plugin will be imported to use in our code. But we will need to have gulp installed on this project folder (under <strong>node_modules</strong>) but this is no problem because we did it before using the <strong>package.json file devDependencies: “gulp”: “3.9.1”.</strong></p>
<p>For this specific example, this is our gulpfile.js sample file, used to compile, optimize and upload LESS / CSS files to SharePoint Online:</p>
<script src="https://gist.github.com/jquintozamora/3158fc93a879cfce8c12e4e79c55ce6e.js"></script>

<p>I’d like to clarify some <strong>gulp concepts</strong> and <strong>functions</strong> used in this code:</p>
<h3 id="General-concepts-of-Gulp"><a href="#General-concepts-of-Gulp" class="headerlink" title="General concepts of Gulp"></a>General concepts of Gulp</h3><ul>
<li><p><strong>require</strong>: this keyword is used to import a module (npm module for example).</p>
</li>
<li><p><strong>gulp.task</strong> function creates task to be <strong>executed</strong> <strong>on</strong> <strong>demand</strong> or attached to <strong>before build</strong>, <strong>after build</strong>, <strong>clean</strong> or <strong>project</strong> <strong>open</strong> events. More information here: <a href="https://github.com/gulpjs/gulp/blob/master/docs/API.md#gulptaskname--deps--fn" target="_blank" rel="noopener">https://github.com/gulpjs/gulp/blob/master/docs/API.md#gulptaskname–deps–fn</a> or <a href="https://gulp.readme.io/docs/gulptaskname-fn" target="_blank" rel="noopener">https://gulp.readme.io/docs/gulptaskname-fn</a></p>
</li>
<li><p><strong>gulp.src</strong> function defines source files to use in the gulp <strong>pipeline</strong>. More info: <a href="https://github.com/gulpjs/gulp/blob/master/docs/API.md#gulpsrcglobs-options" target="_blank" rel="noopener">https://github.com/gulpjs/gulp/blob/master/docs/API.md#gulpsrcglobs-options</a> and <a href="https://gulp.readme.io/docs/gulpsrcglobs-options" target="_blank" rel="noopener">https://gulp.readme.io/docs/gulpsrcglobs-options</a></p>
</li>
<li><p><strong>.pipe</strong> function:
The whole build system of Gulp is based on a <strong>streams concept</strong>. Gulp provides a ‘starting stream’, which you create via <strong>gulp.src</strong>. It takes a path as an input and returns a stream of (virtual) files as an output. All you do then using<strong> .pipe()</strong> is passing this output as an input of a <strong>transformation</strong>, which takes a stream of virtual files as an input and returns transformed virtual files as an output.</p>
</li>
</ul>
<p>On the ‘end’ side of this transformation is <strong>gulp.dest</strong> - it takes a stream of virtual files as an input and writes a real ones as the output in a directory specified as parameter of this transformation. That means <strong>each task should consist of a sequence of stream transformations ended with a final gulp.dest transformation</strong>. Source: <a href="http://blog.arkency.com/2015/03/gulp-modern-approach-to-asset-pipeline-for-rails-developers/" target="_blank" rel="noopener">http://blog.arkency.com/2015/03/gulp-modern-approach-to-asset-pipeline-for-rails-developers/</a></p>
<ul>
<li><p><strong>gulp.watch</strong> function are used to watch files and do something when a file changes. More info here: <a href="https://github.com/gulpjs/gulp/blob/master/docs/API.md#gulpwatchglob--opts-tasks-or-gulpwatchglob--opts-cb" target="_blank" rel="noopener">https://github.com/gulpjs/gulp/blob/master/docs/API.md#gulpwatchglob–opts-tasks-or-gulpwatchglob–opts-cb</a> or <a href="https://gulp.readme.io/docs/gulpwatchglob-opts-fn" target="_blank" rel="noopener">https://gulp.readme.io/docs/gulpwatchglob-opts-fn</a></p>
</li>
<li><p>The way gulp implements <strong>dependency</strong> <strong>between</strong> <strong>tasks</strong> is by adding array of dependencies in the task definition for example: gulp.task(“css-upload-to-sharepoint”, <strong>[‘css-optimize’]</strong>, function () {…}); defines “css-upload-to-sharepoint” task but force to execute “css-optimize” task before.</p>
</li>
</ul>
<h3 id="Functions-and-3rd-party-plugins"><a href="#Functions-and-3rd-party-plugins" class="headerlink" title="Functions and 3rd party plugins"></a>Functions and 3rd party plugins</h3><ul>
<li><p><strong>gulp-load-plugins</strong> (<a href="https://www.npmjs.com/package/gulp-load-plugins" target="_blank" rel="noopener">https://www.npmjs.com/package/gulp-load-plugins</a>) plugin will be used to lazy load the plugins on demand. Then we need to use the “$.” before the name of the module when we want to use them i.e. $.less().</p>
</li>
<li><p>We can use <strong>functions inside a gulp task</strong>. i.e. The function <strong>uploadToSharePoint</strong> is used in order to upload separately the normal CSS file and the themed one inside the same task.</p>
</li>
<li><p><strong>require(‘./gulp.config’)();</strong> will load all configuration settings stored in a separate file called “gulp.config.js”. Note this is some kind of standard as you can see in the John Papa gulp patterns (<a href="https://github.com/johnpapa/gulp-patterns" target="_blank" rel="noopener">https://github.com/johnpapa/gulp-patterns</a>).</p>
</li>
<li><p><strong>gulp-ccso</strong> plugin is intended to minify and optimize the CSS file. <a href="https://www.npmjs.com/package/gulp-csso" target="_blank" rel="noopener">https://www.npmjs.com/package/gulp-csso</a></p>
</li>
<li><p><strong>gulp-print</strong> plugin is used to print names of files to the console so that you can see what’s going through the the gulp pipe. <a href="https://www.npmjs.com/package/gulp-print" target="_blank" rel="noopener">https://www.npmjs.com/package/gulp-print</a></p>
</li>
<li><p><strong>gulp-less</strong> plugin is intended to compile LESS files into CSS. <a href="https://www.npmjs.com/package/gulp-less" target="_blank" rel="noopener">https://www.npmjs.com/package/gulp-less</a></p>
</li>
<li><p><strong>gulp-autoprefixer</strong> plugin is intended to add some tags in the css to made it compatible with more browsers. <a href="https://www.npmjs.com/package/gulp-autoprefixer" target="_blank" rel="noopener">https://www.npmjs.com/package/gulp-autoprefixer</a></p>
</li>
<li><p><strong>gulp-spsave</strong> plugin is used to to upload files to SharePoint. If you want read more, you can read Vard post here: <a href="http://www.vrdmn.com/2016/05/simple-bundle-minify-and-upload-js-to.html" target="_blank" rel="noopener">http://www.vrdmn.com/2016/05/simple-bundle-minify-and-upload-js-to.html</a></p>
</li>
<li><p><strong><binding beforebuild="css-optimize"></binding></strong> that line is very important to indicate to VS 2015 the task “css-optimize” must be executed <strong>before build</strong> the project.</p>
</li>
</ul>
<h2 id="Create-Gulp-configuration-file-in-VS-2015"><a href="#Create-Gulp-configuration-file-in-VS-2015" class="headerlink" title="Create Gulp configuration file in VS 2015"></a>Create Gulp configuration file in VS 2015</h2><p>Let’s create a configuration file, because we will need some place where we can put the configuration parameters for out gulp file. There are lots of ways to do that, but my preferred one is just create a separated JS file called “gulp.config.js” which is sort of standard in web development world.</p>
<p><a href="./clip_image014.png"><img src="./clip_image014.png" alt="clip_image014" title="clip_image014"></a></p>
<script src="https://gist.github.com/jquintozamora/1c6982e3ab00c982cad973f78c65706f.js"></script>

<p>In this example we must note:</p>
<ul>
<li><strong>This isn’t .json file, it is .js instead</strong>. The reason is because we want to use the parameters as a function directly.</li>
<li>In the UserConfig you should put you <strong>LocalMachineUser</strong> and tenant information. This will be used by <strong>gulp-spsave</strong> plugin.</li>
</ul>
<p>I highly <strong>recommend</strong> <strong>John Papa’s Gulp course</strong>: <a href="https://www.pluralsight.com/courses/javascript-build-automation-gulpjs" target="_blank" rel="noopener">https://www.pluralsight.com/courses/javascript-build-automation-gulpjs</a></p>
<h2 id="How-to-manage-gulp-tasks-using-Task-Runner-Explorer-in-VS-2015"><a href="#How-to-manage-gulp-tasks-using-Task-Runner-Explorer-in-VS-2015" class="headerlink" title="How to manage gulp tasks using Task Runner Explorer in VS 2015"></a>How to manage gulp tasks using Task Runner Explorer in VS 2015</h2><p>You can view <strong>Task Runner Explorer</strong> using View menu in <strong>Visual Studio 2015</strong>:</p>
<p><a href="./clip_image015.png"><img src="./clip_image015.png" alt="clip_image015" title="clip_image015"></a></p>
<p>Once enabled, this is how <strong>Task Runner Explorer</strong> looks:</p>
<p><a href="./clip_image016.png"><img src="./clip_image016.png" alt="clip_image016" title="clip_image016"></a></p>
<p><strong>Note</strong> that Task Runner Explorer uses the current project <strong>gulpfile.js</strong> (<strong>MUST</strong> be in the root folder of the project) to analyse it and provide the <strong>Tasks and Bindings Views</strong>.</p>
<p>In the <strong>Bindings view</strong> we can see how the task <strong>“css-optimize”</strong> is configured to run <strong>before</strong> building the project.</p>
<p>In the <strong>Tasks view</strong> you can configure <strong>Bindings</strong> and we also can run gulp talks by clicking right button and “<strong>Run</strong>“:</p>
<p><a href="./clip_image017.png"><img src="./clip_image017.png" alt="clip_image017" title="clip_image017"></a></p>
<h3 id="Run-css-optimize-task"><a href="#Run-css-optimize-task" class="headerlink" title="Run css-optimize task"></a>Run css-optimize task</h3><p>If we run the <strong>“css-optimize”</strong> task we see how gulp runs <strong>two</strong> <strong>tasks</strong>, first <strong>“less-compile”</strong> and second <strong>“css-optimize”</strong> as the first one is dependent on the second one:</p>
<p><a href="./clip_image018.png"><img src="./clip_image018.png" alt="clip_image018" title="clip_image018"></a></p>
<p>You can see how <strong>VS opens</strong> a <strong>screen</strong> to allow us to <strong>follow the process</strong>. We can see names of the files in pink because we used gulp-print plugin to show them.</p>
<p>After running this tasks we will generate 4 files in Output directory (<strong>JQ.MasterPage.css, JQ.MasterPage.min.css, JQ.Themable.css and JQ.Themable.min.css</strong>) as we indicated on gulp configuration file.</p>
<p>&nbsp;</p>
<h3 id="Run-css-upload-to-sharepoint-task"><a href="#Run-css-upload-to-sharepoint-task" class="headerlink" title="Run css-upload-to-sharepoint task"></a>Run css-upload-to-sharepoint task</h3><p>As we have three tasks and two dependencies, then if we execute <strong>css-upload-to-sharepoint</strong>, then will be executed css-optimize and therefore will be executed “less-compile” because how are configured the dependencies. So, if we have changed some <strong>LESS</strong> files and we want to update the file into SharePoint the only thing to do is right click on the task and Run:</p>
<p><a href="./clip_image019.png"><img src="./clip_image019.png" alt="clip_image019" title="clip_image019"></a></p>
<p>You can see in the console all the process.</p>
<p>And if you navigate to your site you can see <strong>two files</strong> uploaded to <strong>Styles</strong> and <strong>en-us/Themable</strong> folders inside Style Library in our <strong>SharePoint Online (or OnPrem</strong>).</p>
<p><a href="./clip_image020.png"><img src="./clip_image020.png" alt="clip_image020" title="clip_image020"></a></p>
<p><a href="./clip_image021.png"><img src="./clip_image021.png" alt="clip_image021" title="clip_image021"></a></p>
<p>&nbsp;</p>
<h3 id="Run-watcher-less-task"><a href="#Run-watcher-less-task" class="headerlink" title="Run watcher-less task"></a>Run watcher-less task</h3><p><strong>Watcher-less task is intended to listen all LESS files</strong> (update event) and when some of these files are modified, then it will run “<strong>css-upload-to-sharepoint”</strong> task.</p>
<p>If you run watcher-less task you can see how one console appears and keep running listening to changes in LESS files:</p>
<p><a href="./clip_image022.png"><img src="./clip_image022.png" alt="clip_image022" title="clip_image022"></a></p>
<p>Now, If you change a LESS file you can see how the task runs! <strong>This is magic!!</strong></p>
<p>&nbsp;</p>
<h2 id="Include-Output-files-in-the-Project-module-and-Solution"><a href="#Include-Output-files-in-the-Project-module-and-Solution" class="headerlink" title="Include Output files in the Project, module and Solution"></a>Include Output files in the Project, module and Solution</h2><p>After compile and optimize our css files with gulp task, we need to take into account that these final files created, need to be <strong>included in our project, module and solution</strong>. Follow these steps:</p>
<p>Show all files, check and uncheck</p>
<p><a href="./clip_image023.png"><img src="./clip_image023.png" alt="clip_image023" title="clip_image023"></a></p>
<p>We can see the new files aren’t included in the project</p>
<p><a href="./clip_image024.png"><img src="./clip_image024.png" alt="clip_image024" title="clip_image024"></a></p>
<p>Select them:</p>
<p><a href="./clip_image025.png"><img src="./clip_image025.png" alt="clip_image025" title="clip_image025"></a></p>
<p><strong>Include in the project</strong>:</p>
<p><a href="./clip_image026.png"><img src="./clip_image026.png" alt="clip_image026" title="clip_image026"></a></p>
<p>Here they are:</p>
<p><a href="./clip_image027.png"><img src="./clip_image027.png" alt="clip_image027" title="clip_image027"></a></p>
<p>Now, because these files are inside a SharePoint module, <strong>we need to configure the .css (not .min.css) files to not deploy</strong>:</p>
<p><a href="./clip_image028.png"><img src="./clip_image028.png" alt="clip_image028" title="clip_image028"></a></p>
<p>Change the <strong>deployment type properties </strong>of the file to<strong> NoDeployment</strong>.</p>
<p><a href="./clip_image029.png"><img src="./clip_image029.png" alt="clip_image029" title="clip_image029"></a></p>
<p>Now we have included the files in the project we will include them in the Module, editing the Elements.xml file as follows:</p>
<script src="https://gist.github.com/jquintozamora/a389695630a6b77da7c53a113808f430.js"></script>

<p>&nbsp;</p>
<p><a href="./clip_image030.png"><img src="./clip_image030.png" alt="clip_image030" title="clip_image030"></a></p>
<p>Now, the <strong>result is that we have this folder structure</strong>:</p>
<p><a href="./clip_image031.png"><img src="./clip_image031.png" alt="clip_image031" title="clip_image031"></a></p>
<p><strong>But</strong> we only <strong>will be deploying in SharePoint</strong> (inside the Module via feature) <strong>two files:</strong> <strong>JQ.MasterPage.min.css</strong> and <strong>JQ.Themable.min.css</strong>. And that is ideal because we are <strong>combining the power of LESS and Gulp inside a SharePoint Project</strong>.</p>
<h2 id="Download-full-project"><a href="#Download-full-project" class="headerlink" title="Download full project"></a>Download full project</h2><p>You can download full project <a href="./JQ.SharePoint.GulpSample.zip">here</a>.</p>
</div><div id="post-content-bottom-space"><p>&nbsp;</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://twitter.com/jquintozamora" target="_blank">José Quinto</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://blog.josequinto.com/2016/05/20/compile-optimize-and-watch-our-less-css-files-with-gulp-tasks-using-visual-studio-2015-in-our-sharepoint-online-solutions/">https://blog.josequinto.com/2016/05/20/compile-optimize-and-watch-our-less-css-files-with-gulp-tasks-using-visual-studio-2015-in-our-sharepoint-online-solutions/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/category/CSS/">CSS</a><a class="post-meta__tags" href="/category/Gulp/">Gulp</a><a class="post-meta__tags" href="/category/LESS/">LESS</a><a class="post-meta__tags" href="/category/Node/">Node</a><a class="post-meta__tags" href="/category/Node-js/">Node.js</a><a class="post-meta__tags" href="/category/Office-365/">Office 365</a><a class="post-meta__tags" href="/category/SharePoint-Online/">SharePoint Online</a></div></article><nav id="pagination"><div class="prev-post pull-left"><a href="/2016/06/01/how-to-list-all-site-custom-actions-using-csom-and-powershell-in-office-365/" title="previous page"><i class="fa fa-chevron-left" aria-hidden="true"></i><span>How to list all Site Custom Actions using CSOM and PowerShell in Office 365</span></a></div><div class="next-post pull-right"><a href="/2016/05/04/how-to-configure-visual-studio-2015-integration-with-latest-version-of-node-js-and-npm/" title="next page"><span>How to configure Visual Studio 2015 with the latest version of Node.js and NPM</span><i class="fa fa-chevron-right" aria-hidden="true"></i></a></div></nav><div id="disqus_thread"></div><script>var disqus_config = function () {
  this.page.url = 'https://blog.josequinto.com/2016/05/20/compile-optimize-and-watch-our-less-css-files-with-gulp-tasks-using-visual-studio-2015-in-our-sharepoint-online-solutions/';
  this.page.identifier = '753';
  this.page.title = 'Compile, optimize and watch our LESS / CSS files with Gulp tasks using Visual Studio 2015 in our SharePoint Online solutions';
}
var d = document, s = d.createElement('script');
s.src = "https://https-blog-josequinto-com.disqus.com/embed.js";
s.setAttribute('data-timestamp', '' + +new Date());
(d.head || d.body).appendChild(s);</script><script id="dsq-count-src" src="//https-blog-josequinto-com.disqus.com/count.js" async></script></section></section></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2022 By José Quinto</div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i></div><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.1"></script><script src="/js/fancybox.js?version=1.5.1"></script><script src="/js/copy.js?version=1.5.1"></script><script src="/js/scroll.js?version=1.5.1"></script><script src="/js/head.js?version=1.5.1"></script><script src="/js/search/algolia.js"></script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-44570510-1', 'auto');
ga('send', 'pageview');</script><script async src="https://www.google-analytics.com/analytics.js"></script><link rel="manifest" href="/manifest.json"><script async src="/js/registerServiceWorker.js"></script></body></html>