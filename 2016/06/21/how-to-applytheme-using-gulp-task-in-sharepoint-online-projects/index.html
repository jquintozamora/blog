<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Accept-CH" content="DPR, Viewport-Width, Width"><title>How to ApplyTheme using Gulp Task in  SharePoint Online Projects | José Quinto</title><meta name="description" content="How to ApplyTheme using Gulp Task in  SharePoint Online Projects"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover"><meta property="og:image" content="https://blog.josequinto.com/2016/06/21/how-to-applytheme-using-gulp-task-in-sharepoint-online-projects/featured.png"><meta name="twitter:image" content="https://blog.josequinto.com/2016/06/21/how-to-applytheme-using-gulp-task-in-sharepoint-online-projects/featured.png"><meta property="fb:app_id" content="155567495101835"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:url" content="https://blog.josequinto.com/2016/06/21/how-to-applytheme-using-gulp-task-in-sharepoint-online-projects/" property="og:url"><meta name="twitter:title" content="How to ApplyTheme using Gulp Task in  SharePoint Online Projects | José Quinto" property="og:title"><meta name="twitter:site" content="@jquintozamora"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.josequinto.com/2016/06/21/how-to-applytheme-using-gulp-task-in-sharepoint-online-projects/"><meta property="og:title" content="How to ApplyTheme using Gulp Task in  SharePoint Online Projects | José Quinto"><link rel="canonical" href="https://blog.josequinto.com/2016/06/21/how-to-applytheme-using-gulp-task-in-sharepoint-online-projects/"><link rel="author" href="https://plus.google.com/u/0/108403117712061507579"><link rel="alternate" type="application/rss+xml" title="Jose Quinto" href="https://blog.josequinto.com/feed.rss"><meta name="theme-color" content="#ffffff"><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.1"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.js" defer></script><script>var GLOBAL = { 
  root: '/',
  algolia: {"appId":"C7MOFESP3V","apiKey":"cdc4a9b7af864c710f2d3da5caf59eec","indexName":"dev_JQBLOG","hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><div id="bodyWrapper"><div id="content-outer"><div id="top-container" style="background-image: url(/background.svg)"><div id="page-header"><span class="pull-left"> <a class="brand" href="/"><img class="brand-image" src="/jose-quinto.png"><div class="brand-name">José Quinto</div></a></span><i class="fa fa-share toggle-social" aria-hidden="true"></i><div class="socialicons" id="header-social-icons"><a class="social-icon" href="https://twitter.com/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-twitter"></i></a><a class="social-icon" href="https://github.com/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-github"></i></a><a class="social-icon" href="https://codepen.io/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-codepen"></i></a><a class="social-icon" href="https://www.linkedin.com/in/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-linkedin"></i></a><a class="social-icon" href="https://stackoverflow.com/users/5015774/jos%C3%A9-quinto-zamora?tab=profile" target="_blank" rel="noopener"><i class="fa fa-stack-overflow"></i></a><a class="social-icon" href="https://blog.josequinto.com/feed.rss" target="_blank" rel="noopener"><i class="fa fa-rss"></i></a></div><a class="social-icon search"><i class="fa fa-search"></i></a><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Search posts:</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/about.html">About</a></span></div><div id="post-info"><div id="post-title">How to ApplyTheme using Gulp Task in  SharePoint Online Projects</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2016-06-21</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/taxonomy/Article/">Article</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/taxonomy/Article/Concept-Explained/">Concept-Explained</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/taxonomy/Article/Concept-Explained/Code-Reminder/">Code-Reminder</a><span class="post-meta__separator">|</span><i class="fa fa-comment-o post-meta__icon" aria-hidden="true"></i><a href="/2016/06/21/how-to-applytheme-using-gulp-task-in-sharepoint-online-projects/#disqus_thread"><span class="disqus-comment-count" data-disqus-identifier="2016/06/21/how-to-applytheme-using-gulp-task-in-sharepoint-online-projects/"></span></a></div></div></div><div class="layout" id="content-inner"><section class="articlePostContainer"><nav class="sidebar-toc"><div class="sidebar-toc__title">Contents</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Why-do-we-need-a-Gulp-task-to-Apply-a-SharePoint-theme"><span class="toc-number">2.</span> <span class="toc-text">Why do we need a Gulp task to Apply a SharePoint theme?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-to-create-Gulp-task-and-use-ApplyTheme-method"><span class="toc-number">3.</span> <span class="toc-text">How to create Gulp task and use ApplyTheme method?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Important-Notes"><span class="toc-number">4.</span> <span class="toc-text">Important Notes</span></a></li></ol></div></nav><section class="postArticle"><article id="post"><div class="post-featuredImage"><img src="featured.png" width="auto" height="auto"></div><div id="post-content"><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>This blog post will show you how to create a Gulp task in <strong>Visual Studio 2015</strong> intended to Apply a SharePoint theme with custom spcolor file. </p>
<h2 id="Why-do-we-need-a-Gulp-task-to-Apply-a-SharePoint-theme"><a href="#Why-do-we-need-a-Gulp-task-to-Apply-a-SharePoint-theme" class="headerlink" title="Why do we need a Gulp task to Apply a SharePoint theme?"></a>Why do we need a Gulp task to Apply a SharePoint theme?</h2><p>For example, if we are playing with our CSS files, changing some properties, classes, etc. and we want to see how it looks in SharePoint sites. Then, we have two options:</p>
<ol>
<li><p>We are using custom <a href="https://msdn.microsoft.com/en-us/library/office/dn266906.aspx" target="_blank" rel="noopener">themable CSS files</a>.</p>
</li>
<li><p>We are using custom CSS (non-themable)</p>
</li>
</ol>
<p>Let’s assume we are using <strong>themable css</strong> in our <strong>SharePoint Online</strong> project, then playing, trying, and testing CSS classes is <strong>tricky</strong> because SharePoint, OOTB is using <strong>Theming Engine</strong> to convert our CSS to Themed CSS files (stored eventually under <strong>/_catalogs/theme/Themed folder</strong>). </p>
<p>Let’s assume again, we are using<strong> Gulp</strong> as a <strong>task manager</strong> and we have our task to <strong>compile LESS</strong> files, <strong>optimize</strong> CSS, and <strong>upload</strong> it to SharePoint automatically (as you can see in my previous article: <a href="/2016/05/20/compile-optimize-and-watch-our-less-css-files-with-gulp-tasks-using-visual-studio-2015-in-our-sharepoint-online-solutions">Gulp tasks to compile LESS, optimize and upload CSS to SharePoint.</a></p>
<p><strong>Then here is the problem</strong>, even if we upload to SharePoint our final CSS files, the final styles will not be applied because we have the original CSS, but not the converted CSS stored in Theme library (<strong>/_catalogs/theme/Themed</strong>). That means, <strong>we need to Apply the theme using our SPColor file in order to get the converted themedcss files</strong>.</p>
<blockquote>
<p><strong>Important: </strong>that applies if you are using the old theming engine, if you are using the new theming engine then all the conversion will be done in runtime instead as a background process. You can see more infomation here: <a href="http://www.eliostruyf.com/using-new-theming-engine-sharepoint-online/" title="http://www.eliostruyf.com/using-new-theming-engine-sharepoint-online/" target="_blank" rel="noopener">http://www.eliostruyf.com/using-new-theming-engine-sharepoint-online/</a>. </p>
</blockquote>
<p>&nbsp;</p>
<h2 id="How-to-create-Gulp-task-and-use-ApplyTheme-method"><a href="#How-to-create-Gulp-task-and-use-ApplyTheme-method" class="headerlink" title="How to create Gulp task and use ApplyTheme method?"></a>How to create Gulp task and use ApplyTheme method?</h2><p>We will use REST web services to Apply theme from Gulp task. </p>
<p>We will use a NPM plugin called <a href="https://www.npmjs.com/package/sp-request" target="_blank" rel="noopener">sp-request</a> to authenticate with SharePoint.</p>
<script src="https://gist.github.com/jquintozamora/4c1d782fbeef3d508239d3449d5f2a0e.js"></script> 

<p>&nbsp;</p>
<h2 id="Important-Notes"><a href="#Important-Notes" class="headerlink" title="Important Notes"></a>Important Notes</h2><ul>
<li><p>We must <strong>include in our package.json</strong> “<strong>sp-request</strong>” dev dependency: <strong>“sp-request”: “^1.1.3”</strong></p>
</li>
<li><p><strong>colorPaletteUrl</strong> requires the site collection relative url to work fine.</p>
</li>
</ul>
</div><div id="post-content-bottom-space"><p>&nbsp;</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://twitter.com/jquintozamora" target="_blank">José Quinto</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://blog.josequinto.com/2016/06/21/how-to-applytheme-using-gulp-task-in-sharepoint-online-projects/">https://blog.josequinto.com/2016/06/21/how-to-applytheme-using-gulp-task-in-sharepoint-online-projects/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/category/CSS/">CSS</a><a class="post-meta__tags" href="/category/Gulp/">Gulp</a><a class="post-meta__tags" href="/category/Office-365/">Office 365</a><a class="post-meta__tags" href="/category/Theming-engine/">Theming engine</a></div></article><nav id="pagination"><div class="prev-post pull-left"><a href="/2016/07/11/office-365-pnp-provisioning-hide-default-title-column-and-enable-menu-for-other-custom-text-column/" title="previous page"><i class="fa fa-chevron-left" aria-hidden="true"></i><span>Office 365. PnP Provisioning – Hide default Title column and Enable menu for Other Custom Text Column</span></a></div><div class="next-post pull-right"><a href="/2016/06/14/office-365-cannot-convert-object-problem-when-provisioning-pnpfile-display-template/" title="next page"><span>Office 365. Cannot Convert Object Problem when provisioning pnp:File Display Template</span><i class="fa fa-chevron-right" aria-hidden="true"></i></a></div></nav><div id="disqus_thread"></div><script>var disqus_config = function () {
  this.page.url = 'https://blog.josequinto.com/2016/06/21/how-to-applytheme-using-gulp-task-in-sharepoint-online-projects/';
  this.page.identifier = '768';
  this.page.title = 'How to ApplyTheme using Gulp Task in  SharePoint Online Projects';
}
var d = document, s = d.createElement('script');
s.src = "https://https-blog-josequinto-com.disqus.com/embed.js";
s.setAttribute('data-timestamp', '' + +new Date());
(d.head || d.body).appendChild(s);</script><script id="dsq-count-src" src="//https-blog-josequinto-com.disqus.com/count.js" async></script></section></section></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2022 By José Quinto</div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i></div><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.1"></script><script src="/js/fancybox.js?version=1.5.1"></script><script src="/js/copy.js?version=1.5.1"></script><script src="/js/scroll.js?version=1.5.1"></script><script src="/js/head.js?version=1.5.1"></script><script src="/js/search/algolia.js"></script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-44570510-1', 'auto');
ga('send', 'pageview');</script><script async src="https://www.google-analytics.com/analytics.js"></script><link rel="manifest" href="/manifest.json"><script async src="/js/registerServiceWorker.js"></script></body></html>