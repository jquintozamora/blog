<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Accept-CH" content="DPR, Viewport-Width, Width"><title>How to provide SharePointContext to a Web API Action (ApiController) in a Provider-hosted SharePoint Add-In | José Quinto</title><meta name="description" content="How to provide SharePointContext to a Web API Action (ApiController) in a Provider-hosted SharePoint Add-In"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover"><meta property="og:image" content="https://blog.josequinto.com/2016/09/05/how-to-provide-sharepointcontext-to-a-web-api-action-apicontroller-in-a-sharepoint-provider-hosted-app/featured.png"><meta name="twitter:image" content="https://blog.josequinto.com/2016/09/05/how-to-provide-sharepointcontext-to-a-web-api-action-apicontroller-in-a-sharepoint-provider-hosted-app/featured.png"><meta property="fb:app_id" content="155567495101835"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:url" content="https://blog.josequinto.com/2016/09/05/how-to-provide-sharepointcontext-to-a-web-api-action-apicontroller-in-a-sharepoint-provider-hosted-app/" property="og:url"><meta name="twitter:title" content="How to provide SharePointContext to a Web API Action (ApiController) in a Provider-hosted SharePoint Add-In | José Quinto" property="og:title"><meta name="twitter:site" content="@jquintozamora"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.josequinto.com/2016/09/05/how-to-provide-sharepointcontext-to-a-web-api-action-apicontroller-in-a-sharepoint-provider-hosted-app/"><meta property="og:title" content="How to provide SharePointContext to a Web API Action (ApiController) in a Provider-hosted SharePoint Add-In | José Quinto"><link rel="canonical" href="https://blog.josequinto.com/2016/09/05/how-to-provide-sharepointcontext-to-a-web-api-action-apicontroller-in-a-sharepoint-provider-hosted-app/"><link rel="author" href="https://plus.google.com/u/0/108403117712061507579"><link rel="alternate" type="application/rss+xml" title="Jose Quinto" href="https://blog.josequinto.com/feed.rss"><meta name="theme-color" content="#ffffff"><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.1"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.js" defer></script><script>var GLOBAL = { 
  root: '/',
  algolia: {"appId":"C7MOFESP3V","apiKey":"cdc4a9b7af864c710f2d3da5caf59eec","indexName":"dev_JQBLOG","hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><div id="bodyWrapper"><div id="content-outer"><div id="top-container" style="background-image: url(/background.svg)"><div id="page-header"><span class="pull-left"> <a class="brand" href="/"><img class="brand-image" src="/jose-quinto.png"><div class="brand-name">José Quinto</div></a></span><i class="fa fa-share toggle-social" aria-hidden="true"></i><div class="socialicons" id="header-social-icons"><a class="social-icon" href="https://twitter.com/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-twitter"></i></a><a class="social-icon" href="https://github.com/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-github"></i></a><a class="social-icon" href="https://codepen.io/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-codepen"></i></a><a class="social-icon" href="https://www.linkedin.com/in/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-linkedin"></i></a><a class="social-icon" href="https://stackoverflow.com/users/5015774/jos%C3%A9-quinto-zamora?tab=profile" target="_blank" rel="noopener"><i class="fa fa-stack-overflow"></i></a><a class="social-icon" href="https://blog.josequinto.com/feed.rss" target="_blank" rel="noopener"><i class="fa fa-rss"></i></a></div><a class="social-icon search"><i class="fa fa-search"></i></a><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Search posts:</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/about.html">About</a></span></div><div id="post-info"><div id="post-title">How to provide SharePointContext to a Web API Action (ApiController) in a Provider-hosted SharePoint Add-In</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2016-09-05</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/taxonomy/How-To/">How-To</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/taxonomy/How-To/Concept-Explained/">Concept-Explained</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/taxonomy/How-To/Concept-Explained/Code-Reminder/">Code-Reminder</a><span class="post-meta__separator">|</span><i class="fa fa-comment-o post-meta__icon" aria-hidden="true"></i><a href="/2016/09/05/how-to-provide-sharepointcontext-to-a-web-api-action-apicontroller-in-a-sharepoint-provider-hosted-app/#disqus_thread"><span class="disqus-comment-count" data-disqus-identifier="2016/09/05/how-to-provide-sharepointcontext-to-a-web-api-action-apicontroller-in-a-sharepoint-provider-hosted-app/"></span></a></div></div></div><div class="layout" id="content-inner"><section class="articlePostContainer"><nav class="sidebar-toc"><div class="sidebar-toc__title">Contents</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-SharePoint-Context-and-Authentication-works"><span class="toc-number">2.</span> <span class="toc-text">How SharePoint Context and Authentication works</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-problem-with-SharePointContextFilterAttribute-and-Web-API"><span class="toc-number">3.</span> <span class="toc-text">The problem with SharePointContextFilterAttribute and Web API</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#My-Solution"><span class="toc-number">3.1.</span> <span class="toc-text">My Solution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-approach"><span class="toc-number">3.2.</span> <span class="toc-text">The approach</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Testing-the-solution-is-working-properly"><span class="toc-number">4.</span> <span class="toc-text">Testing the solution is working properly</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Read-more…"><span class="toc-number">5.</span> <span class="toc-text">Read more…</span></a></li></ol></div></nav><section class="postArticle"><article id="post"><div class="post-featuredImage"><img src="featured.png" width="auto" height="auto"></div><div id="post-content"><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Recently I have been played with <strong>Azure Web Apps</strong>, and its integration with <strong>SharePoint</strong>. In this post we will see how to provide Authentication to<strong> Web API REST </strong>actions using <strong>SharePointContext</strong>, which means that we only will be able to invoke our REST actions if we are behind the context of <strong>SharePoint Provider-hosted App</strong>.<br>It’s really easy and well documented to use SharePointContextFilter in a typical MVC project, but when you try to apply to Web API project, then is really tricky.   </p>
<h2 id="How-SharePoint-Context-and-Authentication-works"><a href="#How-SharePoint-Context-and-Authentication-works" class="headerlink" title="How SharePoint Context and Authentication works"></a>How SharePoint Context and Authentication works</h2><p>When we want to provide <strong>SharePoint Context and Authentication</strong> into a normal MVC Web App, we should include the package called “<a href="https://www.nuget.org/packages/AppForSharePointWebToolkit/" target="_blank" rel="noopener"><strong>AppForSharePointWebToolKit</strong></a>“ and this package will add to the project three files:  </p>
<ul>
<li>Filters\SharePointContextFilterAttribute.cs  </li>
<li>SharePointContext.cs  </li>
<li>TokenHelper.cs </li>
</ul>
<p>These files contain <strong>logic</strong> to have the SharePoint context in SharePoint apps that make use of <strong>Azure Access Control Services</strong> (Office 365) and High trust apps (SharePoint OnPremises).<br>In normal <strong>MVC projects</strong> that is ideal because once added this project, you only need to tag your action with [<strong>SharePointContextFilter</strong>] attribute:
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">HomeController</span> : <span class="title">Controller</span></span><br><span class="line">&#123;</span><br><span class="line">  [<span class="meta">SharePointContextFilter</span>]</span><br><span class="line">  <span class="function"><span class="keyword">public</span> ActionResult <span class="title">Index</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>  &#123;</span><br><span class="line">    <span class="keyword">return</span> View();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// more stuff</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>Note that <strong>SharePointContextFilterAttribute</strong> can be used to decorate complete controllers as well!  </p>
</blockquote>
<p><strong>SharePointContextFilter</strong> attribute enforces the SharePoint context, we only can access to Index() if we are in the context of SharePoint Provider-hosted App. For example, <strong>when a user tries to visit directly the web</strong>, and has <strong>not been logged</strong> <strong>in</strong> using the SharePoint Site Content App Launcher (or similar) the user will not be allowed to enter. Moreover, if we go directly to the remote web using the query string parameter but didn’t login on this session, this <strong>SharePointContextFilter</strong> causes a <strong>redirect</strong> to the <strong>SharePoint</strong> <strong>site</strong>, to login to the site and when the user has been logged in, the user will be redirected back to the remote web. <strong>If the user can’t login, the context can’t be created and thus, the code within the action, won’t be executed. So, the SharePointContextFilter causes a redirect to the error page.</strong>  </p>
<blockquote>
<p>This approach sounds ideal to provide SharePointContext and Authentication mechanism as well.  </p>
</blockquote>
<p>&nbsp; </p>
<h2 id="The-problem-with-SharePointContextFilterAttribute-and-Web-API"><a href="#The-problem-with-SharePointContextFilterAttribute-and-Web-API" class="headerlink" title="The problem with SharePointContextFilterAttribute and Web API"></a>The problem with SharePointContextFilterAttribute and Web API</h2><p>If we are building a Web API project or Controller and we want to have the same approach we probably go for applying this solution as well (or try it):<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">HomeController</span> : <span class="title">ApiController</span></span><br><span class="line">&#123;</span><br><span class="line">  [<span class="meta">SharePointContextFilter</span>]</span><br><span class="line">  <span class="function"><span class="keyword">public</span> HttpResponseMessage <span class="title">Get</span>(<span class="params"><span class="keyword">string</span> id</span>)</span></span><br><span class="line"><span class="function"></span>  &#123;</span><br><span class="line">    <span class="comment">// more stuff</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>But, we will realise that doesn’t work!<br>It’s not working because two main reasons:  </p>
<ol>
<li><p>ActionFilterAttribute</p>
<ul>
<li>Controller class WORKS fine with System.Web.Mvc.ActionFilterAttribute</li>
<li><strong>ApiController</strong> class DOESN’T WORK with System.Web.Mvc.ActionFilterAttribute</li>
<li><strong>ApiController</strong> WORKs with System.Web.Http.Filters.ActionFilterAttribute <a href="http://stackoverflow.com/questions/12992722/why-is-my-asp-net-web-api-actionfilterattribute-onactionexecuting-not-firing" target="_blank" rel="noopener">instead</a>. </li>
</ul>
</li>
<li><p>Web API (ApiController) is stateless component</p>
<ul>
<li>Which means that doesn’t have Session State.<br>&nbsp; </li>
</ul>
</li>
</ol>
<h3 id="My-Solution"><a href="#My-Solution" class="headerlink" title="My Solution"></a>My Solution</h3><p> After lot of googling, the community have a couple of solutions:  </p>
<ul>
<li><strong>Bas Lijten</strong>: <a href="http://blog.baslijten.com/getting-sharepoint-2013-apps-and-webapi-to-work/" target="_blank" rel="noopener">http://blog.baslijten.com/getting-sharepoint-2013-apps-and-webapi-to-work/</a>  </li>
<li><strong>Scot Hillier</strong>: <a href="https://www.itunity.com/article/managing-tokens-sharepoint-2013-singlepage-providerhosted-apps-445" target="_blank" rel="noopener">https://www.itunity.com/article/managing-tokens-sharepoint-2013-singlepage-providerhosted-apps-445</a><blockquote>
<p>I tried to apply both without success because my scenario is different. But I got some ideas to solve the problem for my scenario.</p>
</blockquote>
</li>
</ul>
<h3 id="The-approach"><a href="#The-approach" class="headerlink" title="The approach"></a>The approach</h3><ol>
<li><p>Change <strong>WebApiConfig.cs</strong> to enable Session State in Web API (same approach <a href="http://www.strathweb.com/2012/11/adding-session-support-to-asp-net-web-api/" target="_blank" rel="noopener">here</a>).</p>
<script src="https://gist.github.com/jquintozamora/abe9c22734c2d368ac78a15f20ef952e.js"></script> 
</li>
<li><p>Create a new filter called <strong>SharePointContextWebAPIFilterAttribute.cs</strong> behind Filters folder.
<script src="https://gist.github.com/jquintozamora/fc55926328e39df86801dc0e7d9fe53c.js"></script> </p>
<blockquote>
<p><strong>Notes</strong> in the above code:</p>
<ul>
<li>System.Web.Http.Controllers.<strong>HttpActionContext</strong> doesn’t have <strong>HttpContext</strong> object associated, so we will use <strong>HttpContext</strong>.<strong>Current</strong> instead inside OnActionExecuting when called CheckRedirectionStatus method from SharePointContextProvider class..</li>
<li>System.Web.Http.Controllers.<strong>HttpActionContext</strong> doesn’t have Result property, we will use Response property to redirect and create Error response in the code.</li>
</ul>
</blockquote>
</li>
<li><p>Use <strong>SharePointContextWebAPIFilter</strong> instead SharePointContextFilter in our <strong>Web API actions</strong>:</p>
<script src="https://gist.github.com/jquintozamora/0aca058efe7e18ad1562e1fa002c01bf.js"></script> 


</li>
</ol>
<h2 id="Testing-the-solution-is-working-properly"><a href="#Testing-the-solution-is-working-properly" class="headerlink" title="Testing the solution is working properly"></a>Testing the solution is working properly</h2><ol>
<li><p>If we go directly to our REST Service:
<a href="">http://myapp.azurewebsites.net/api/mycustom/1</a></p>
<p>We will receive this error:<br><a href="./clip_image003.png"><img src="./clip_image003.png" alt="clip_image003" title="clip_image003"></a>  </p>
</li>
<li><p>If we go to our SharePoint Provider-hosted app and we click on our App Launcher we will be redirected to login page and after that to an url like that:
<a href="">https://myapp.azurewebsites.net/home/index/?SPHostUrl=https%3A%2F%2Fmytenant%2Esharepoint%2Ecom&amp;SPLanguage=en-US&amp;SPClientTag=0&amp;SPProductNumber=16%2E0%2E5625%2E1208&amp;SPAppWebUrl=https%3A%2F%2Fmytenant-appguid%2Esharepoint%2Ecom&amp;SPHasRedirectedToSharePoint=1</a></p>
<p>This isn’t our Web API, but is our gateway to login into Provider-hosted app. Once logged in, we can change the url “home/index” by our REST call, for example:</p>
<p><a href="">https://myapp.azurewebsites.net/api/mycustom/1/?SPHostUrl=https%3A%2F%2Fmytenant%2Esharepoint%2Ecom&amp;SPLanguage=en-US&amp;SPClientTag=0&amp;SPProductNumber=16%2E0%2E5625%2E1208&amp;SPAppWebUrl=https%3A%2F%2Fmytenant-appguid%2Esharepoint%2Ecom&amp;SPHasRedirectedToSharePoint=1</a></p>
<p>That should give you the information requested in the browser.  </p>
</li>
<li><p>If we are logged in our SharePoint Provider-hosted app and we use F12 (Console) to make an ajax query:</p>
<script src="https://gist.github.com/jquintozamora/a0f0a5e9a08f2b1a066e5742b079cdd1.js"></script>

<p><a href="./clip_image004.png"><img src="./clip_image004.png" alt="clip_image004" title="clip_image004"></a></p>
<blockquote>
<p>If we use ajax we<strong> also need to include the query string (SharePoint context) in the call</strong>:</p>
</blockquote>
<script src="https://gist.github.com/jquintozamora/6e162d8766eb8e00ad69858d75137d94.js"></script>

<blockquote>
<p>Using location.search will include all the parameters needed (thank for the tip <a href="http://sharepointcookies.com/" target="_blank" rel="noopener">Kev</a>):</p>
</blockquote>
<p><a href="./clip_image005.png"><img src="./clip_image005.png" alt="clip_image005" title="clip_image005"></a>  </p>
<p>And here we have successful ajax query to our Web API REST call from our SharePoint Provider-hosted app page.</p>
</li>
</ol>
<h2 id="Read-more…"><a href="#Read-more…" class="headerlink" title="Read more…"></a>Read more…</h2><ul>
<li><p><a href="https://blogs.msdn.microsoft.com/kaevans/2013/09/24/introducing-sharepointcontext-for-provider-hosted-sharepoint-apps/" target="_blank" rel="noopener">Introduction to SharePointContext for Provider-hosted SharePoint Apps</a>  </p>
</li>
<li><p><a href="http://blog.baslijten.com/convert-mvc-application-to-shareptoint-2013-provider-hosted-app/" target="_blank" rel="noopener">Convert MVC Application to SharePoint 2013 Provider-Hosted App</a>  </p>
</li>
<li><p><a href="http://www.asp.net/mvc/overview/older-versions/hands-on-labs/aspnet-mvc-4-custom-action-filters" target="_blank" rel="noopener">ASP.NET MVC 4 Custom Action Filters</a> </p>
</li>
</ul>
</div><div id="post-content-bottom-space"><p>&nbsp;</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://twitter.com/jquintozamora" target="_blank">José Quinto</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://blog.josequinto.com/2016/09/05/how-to-provide-sharepointcontext-to-a-web-api-action-apicontroller-in-a-sharepoint-provider-hosted-app/">https://blog.josequinto.com/2016/09/05/how-to-provide-sharepointcontext-to-a-web-api-action-apicontroller-in-a-sharepoint-provider-hosted-app/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/category/Office-365/">Office 365</a><a class="post-meta__tags" href="/category/Azure/">Azure</a><a class="post-meta__tags" href="/category/ApiController/">ApiController</a><a class="post-meta__tags" href="/category/SharePointContext/">SharePointContext</a><a class="post-meta__tags" href="/category/Web-API/">Web API</a></div></article><nav id="pagination"><div class="prev-post pull-left"><a href="/2016/09/13/how-to-unzip-azure-blobs-programmatically-using-memory-streams-in-azure-webjobs/" title="previous page"><i class="fa fa-chevron-left" aria-hidden="true"></i><span>How to Unzip Azure Blobs programmatically using Memory Streams in Azure WebJOBs</span></a></div><div class="next-post pull-right"><a href="/2016/08/02/enable-log-and-trace-information-for-pnp-core-provisioning-when-using-console-application/" title="next page"><span>Enable Log and Trace information for PnP Core Provisioning when using Console Application</span><i class="fa fa-chevron-right" aria-hidden="true"></i></a></div></nav><div id="disqus_thread"></div><script>var disqus_config = function () {
  this.page.url = 'https://blog.josequinto.com/2016/09/05/how-to-provide-sharepointcontext-to-a-web-api-action-apicontroller-in-a-sharepoint-provider-hosted-app/';
  this.page.identifier = '807';
  this.page.title = 'How to provide SharePointContext to a Web API Action (ApiController) in a Provider-hosted SharePoint Add-In';
}
var d = document, s = d.createElement('script');
s.src = "https://https-blog-josequinto-com.disqus.com/embed.js";
s.setAttribute('data-timestamp', '' + +new Date());
(d.head || d.body).appendChild(s);</script><script id="dsq-count-src" src="//https-blog-josequinto-com.disqus.com/count.js" async></script></section></section></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2020 By José Quinto</div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i></div><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.1"></script><script src="/js/fancybox.js?version=1.5.1"></script><script src="/js/copy.js?version=1.5.1"></script><script src="/js/scroll.js?version=1.5.1"></script><script src="/js/head.js?version=1.5.1"></script><script src="/js/search/algolia.js"></script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-44570510-1', 'auto');
ga('send', 'pageview');</script><script async src="https://www.google-analytics.com/analytics.js"></script><link rel="manifest" href="/manifest.json"><script async src="/js/registerServiceWorker.js"></script></body></html>