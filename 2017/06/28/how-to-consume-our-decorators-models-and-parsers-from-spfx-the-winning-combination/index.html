<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Accept-CH" content="DPR, Viewport-Width, Width"><title>Part 5. How to consume our decorators, models and parsers from SPFx, the winning combination | José Quinto</title><meta name="description" content="Part 5. How to consume our decorators, models and parsers from SPFx, the winning combination"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover"><meta property="og:image" content="https://blog.josequinto.com/2017/06/28/how-to-consume-our-decorators-models-and-parsers-from-spfx-the-winning-combination/featured.png"><meta name="twitter:image" content="https://blog.josequinto.com/2017/06/28/how-to-consume-our-decorators-models-and-parsers-from-spfx-the-winning-combination/featured.png"><meta property="fb:app_id" content="155567495101835"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:url" content="https://blog.josequinto.com/2017/06/28/how-to-consume-our-decorators-models-and-parsers-from-spfx-the-winning-combination/" property="og:url"><meta name="twitter:title" content="Part 5. How to consume our decorators, models and parsers from SPFx, the winning combination | José Quinto" property="og:title"><meta name="twitter:site" content="@jquintozamora"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.josequinto.com/2017/06/28/how-to-consume-our-decorators-models-and-parsers-from-spfx-the-winning-combination/"><meta property="og:title" content="Part 5. How to consume our decorators, models and parsers from SPFx, the winning combination | José Quinto"><link rel="canonical" href="https://blog.josequinto.com/2017/06/28/how-to-consume-our-decorators-models-and-parsers-from-spfx-the-winning-combination/"><link rel="author" href="https://plus.google.com/u/0/108403117712061507579"><link rel="alternate" type="application/rss+xml" title="Jose Quinto" href="https://blog.josequinto.com/feed.rss"><meta name="theme-color" content="#ffffff"><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.1"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.js" defer></script><script>var GLOBAL = { 
  root: '/',
  algolia: {"appId":"C7MOFESP3V","apiKey":"cdc4a9b7af864c710f2d3da5caf59eec","indexName":"dev_JQBLOG","hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><div id="bodyWrapper"><div id="content-outer"><div id="top-container" style="background-image: url(/background.svg)"><div id="page-header"><span class="pull-left"> <a class="brand" href="/"><img class="brand-image" src="/jose-quinto.png"><div class="brand-name">José Quinto</div></a></span><i class="fa fa-share toggle-social" aria-hidden="true"></i><div class="socialicons" id="header-social-icons"><a class="social-icon" href="https://twitter.com/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-twitter"></i></a><a class="social-icon" href="https://github.com/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-github"></i></a><a class="social-icon" href="https://codepen.io/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-codepen"></i></a><a class="social-icon" href="https://www.linkedin.com/in/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-linkedin"></i></a><a class="social-icon" href="https://stackoverflow.com/users/5015774/jos%C3%A9-quinto-zamora?tab=profile" target="_blank" rel="noopener"><i class="fa fa-stack-overflow"></i></a><a class="social-icon" href="https://blog.josequinto.com/feed.rss" target="_blank" rel="noopener"><i class="fa fa-rss"></i></a></div><a class="social-icon search"><i class="fa fa-search"></i></a><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Search posts:</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/about.html">About</a></span></div><div id="post-info"><div id="post-title">Part 5. How to consume our decorators, models and parsers from SPFx, the winning combination</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2017-06-28</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/taxonomy/Series/">Series</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/taxonomy/Series/PnPJsCore/">PnPJsCore</a><span class="post-meta__separator">|</span><i class="fa fa-comment-o post-meta__icon" aria-hidden="true"></i><a href="/2017/06/28/how-to-consume-our-decorators-models-and-parsers-from-spfx-the-winning-combination/#disqus_thread"><span class="disqus-comment-count" data-disqus-identifier="2017/06/28/how-to-consume-our-decorators-models-and-parsers-from-spfx-the-winning-combination/"></span></a></div></div></div><div class="layout" id="content-inner"><section class="articlePostContainer"><nav class="sidebar-toc"><div class="sidebar-toc__title">Contents</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Post-Series-Index"><span class="toc-number">1.</span> <span class="toc-text">Post Series Index</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">2.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SPFx-Web-Part-sample"><span class="toc-number">3.</span> <span class="toc-text">SPFx Web Part sample</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Browser-Console-Screenshots"><span class="toc-number">4.</span> <span class="toc-text">Browser Console Screenshots</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusion"><span class="toc-number">5.</span> <span class="toc-text">Conclusion</span></a></li></ol></div></nav><section class="postArticle"><article id="post"><div class="post-featuredImage"><img src="featured.png" width="auto" height="auto"></div><div id="post-content"><h2 id="Post-Series-Index"><a href="#Post-Series-Index" class="headerlink" title="Post Series Index"></a>Post Series Index</h2><p>This is a blog post in the series about working with <strong>Custom Business Objects</strong>, <strong>Parsers</strong> and <strong>Decorators</strong> in <a href="https://github.com/SharePoint/PnP-JS-Core" target="_blank" rel="noopener">PnP JS Core</a>:</p>
<ol>
<li><a href="/2017/05/19/why-do-we-should-use-custom-business-objects-models-in-pnp-js-core#Post-Series-Index">Introduction to Why do we should use Custom Business Objects (Models) in PnP JS Core</a> </li>
<li><a href="/2017/05/29/creating-select-and-expand-typescript-property-decorators-to-be-used-in-pnp-js-core#Post-Series-Index">Creating select and expand TypeScript Property Decorators to be used in PnP JS Core</a></li>
<li><a href="/2017/06/15/creating-mydocument-and-mydocumentcollection-models-extending-item-and-items-pnp-js-core-classes#Post-Series-Index">Creating MyDocument and MyDocumentCollection models extending Item and Items PnP JS Core classes</a>  </li>
<li><a href="/2017/06/28/create-custom-parser-and-array-parser-to-generate-query-and-property-names-in-pnp-js-core#Post-Series-Index">Create Custom Parser and Array Parser to unify select and property names</a></li>
<li><strong>How to consume our decorators, models and parsers from SPFx, the winning combination (this article)</strong> </li>
<li><a href="https://github.com/jquintozamora/spfx-react-sp-pnp-js-property-decorators" target="_blank" rel="noopener">Github project!</a> <strong>Please remember to “star” if you liked it!</strong></li>
</ol>
<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>In the previous posts of this series we explained why we should use <a href="/2017/05/19/why-do-we-should-use-custom-business-objects-models-in-pnp-js-core/"><strong>Custom Business Objects in PnP JS Core</strong></a> and we implemented <strong>TypeScript decorators,</strong> Custom Business Object <strong>inheriting from Item</strong> and <strong>Items</strong> <strong>PnP JS Core</strong> classes, and <strong>custom Parsers</strong>. In this article, we will see how to use all of them together in order to get the<strong> max benefit from querying PnP JS Core from SharePoint Framework Web Part</strong>.</p>
<h2 id="SPFx-Web-Part-sample"><a href="#SPFx-Web-Part-sample" class="headerlink" title="SPFx Web Part sample"></a>SPFx Web Part sample</h2><p>All code samples we are going to see here, actually, are implemented in this <strong>Github project</strong>: <a href="https://github.com/jquintozamora/spfx-react-sp-pnp-js-property-decorators" title="https://github.com/jquintozamora/spfx-react-sp-pnp-js-property-decorators" target="_blank" rel="noopener">spfx-react-sp-pnp-js-property-decorators</a>.</p>
<blockquote>
<p>There are some <strong>requisites</strong> to have in order to run this webpart sample. 
1. Create a list called PnPJSSample with four columns (ID, Title, Category and Quantity).
2. Upload some documents in the Documents library.</p>
</blockquote>
<p>In the following code sample, we can see different ways to consume and query against PnP JS Core using different combinations of decorators, models and parsers:</p>
<script src="https://gist.github.com/jquintozamora/c5ed551b7e72e8fc31d0dd322a1ad041.js"></script>

<h2 id="Browser-Console-Screenshots"><a href="#Browser-Console-Screenshots" class="headerlink" title="Browser Console Screenshots"></a>Browser Console Screenshots</h2><p>We can see after looking into the different code samples, how they actually work, and what is the result from the browser console:</p>
<p><a href="./image-5.png"><img src="./image-5.png" alt="image" title="image"></a>
<a href="./image-6.png"><img src="./image-6.png" alt="image" title="image"></a>
<a href="./image-7.png"><img src="./image-7.png" alt="image" title="image"></a>
<a href="./image-8.png"><img src="./image-8.png" alt="image" title="image"></a>
<a href="./image-9.png"><img src="./image-9.png" alt="image" title="image"></a>
<a href="./image-10.png"><img src="./image-10.png" alt="image" title="image"></a>
<a href="./image-11.png"><img src="./image-11.png" alt="image" title="image"></a>
<a href="./image-12.png"><img src="./image-12.png" alt="image" title="image"></a>
<a href="./image-13.png"><img src="./image-13.png" alt="image" title="image"></a>
<a href="./image-14.png"><img src="./image-14.png" alt="image" title="image"></a>
<a href="./image-15.png"><img src="./image-15.png" alt="image" title="image"></a>
<a href="./image-16.png"><img src="./image-16.png" alt="image" title="image"></a>
<a href="./image-17.png"><img src="./image-17.png" alt="image" title="image"></a>
<a href="./image-18.png"><img src="./image-18.png" alt="image" title="image"></a>
<a href="./image-19.png"><img src="./image-19.png" alt="image" title="image"></a>
<a href="./image-20.png"><img src="./image-20.png" alt="image" title="image"></a>
<a href="./image-21.png"><img src="./image-21.png" alt="image" title="image"></a></p>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>In my opinion, if we are going to create custom classes in our TypeScript projects for consuming SharePoint lists by using PnP JS Core, the ideal is being integrated with it. And by using decorators will do our life easier and our code more maintainable. </p>
<p>There are multiple ways to create and consume custom objects and parsers, but this post is intended to show the differences and give you an overview in order to decide what to use. </p>
<p>From my point of view, the ideal way to consume is:</p>
<script src="https://gist.github.com/jquintozamora/c321d9dc77591ed75e259f52c5377fc8.js"></script>

<p>Console Result:</p>
<p><a href="./image-22.png"><img src="./image-22.png" alt="image" title="image"></a></p>
<p>And the reason is because:</p>
<ul>
<li>We can use <strong>@select</strong> and <strong>@expand</strong> decorators <strong>efficiently</strong></li>
<li>We can continue using <strong>method chain</strong> after as(MyDocumentCollection). For example <strong>skip(1)</strong></li>
<li><strong>JavaScript objects returned</strong> in the Array are named <strong>MyDocument</strong> (better for <strong>debugging</strong>)</li>
<li>We can use <strong>intellisense</strong> <strong>in VS Code</strong> with our custom model properties (Size, Title and Name).</li>
</ul>
</div><div id="post-content-bottom-space"><p>&nbsp;</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://twitter.com/jquintozamora" target="_blank">José Quinto</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://blog.josequinto.com/2017/06/28/how-to-consume-our-decorators-models-and-parsers-from-spfx-the-winning-combination/">https://blog.josequinto.com/2017/06/28/how-to-consume-our-decorators-models-and-parsers-from-spfx-the-winning-combination/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/category/TypeScript/">TypeScript</a><a class="post-meta__tags" href="/category/PnP-JS-Core/">PnP JS Core</a><a class="post-meta__tags" href="/category/SPFx/">SPFx</a></div></article><nav id="pagination"><div class="prev-post pull-left"><a href="/2017/06/29/dynamic-import-expressions-and-webpack-code-splitting-integration-with-typescript-2-4/" title="previous page"><i class="fa fa-chevron-left" aria-hidden="true"></i><span>Dynamic Import Expressions and webpack 2 Code Splitting integration with TypeScript 2.4</span></a></div><div class="next-post pull-right"><a href="/2017/06/28/create-custom-parser-and-array-parser-to-generate-query-and-property-names-in-pnp-js-core/" title="next page"><span>Part 4. Create Custom Parser and Array Parser to generate query and property names in PnP JS Core</span><i class="fa fa-chevron-right" aria-hidden="true"></i></a></div></nav><div id="disqus_thread"></div><script>var disqus_config = function () {
  this.page.url = 'https://blog.josequinto.com/2017/06/28/how-to-consume-our-decorators-models-and-parsers-from-spfx-the-winning-combination/';
  this.page.identifier = '1073';
  this.page.title = 'Part 5. How to consume our decorators, models and parsers from SPFx, the winning combination';
}
var d = document, s = d.createElement('script');
s.src = "https://https-blog-josequinto-com.disqus.com/embed.js";
s.setAttribute('data-timestamp', '' + +new Date());
(d.head || d.body).appendChild(s);</script><script id="dsq-count-src" src="//https-blog-josequinto-com.disqus.com/count.js" async></script></section></section></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2020 By José Quinto</div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i></div><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.1"></script><script src="/js/fancybox.js?version=1.5.1"></script><script src="/js/copy.js?version=1.5.1"></script><script src="/js/scroll.js?version=1.5.1"></script><script src="/js/head.js?version=1.5.1"></script><script src="/js/search/algolia.js"></script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-44570510-1', 'auto');
ga('send', 'pageview');</script><script async src="https://www.google-analytics.com/analytics.js"></script><link rel="manifest" href="/manifest.json"><script async src="/js/registerServiceWorker.js"></script></body></html>