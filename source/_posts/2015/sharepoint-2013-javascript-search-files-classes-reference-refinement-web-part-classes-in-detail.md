---
layout: post
title: SharePoint 2013 JavaScript Search files classes reference - Refinement Web Part classes in detail
language: English
permalink: sharepoint-2013-javascript-search-files-classes-reference-refinement-web-part-classes-in-detail
id: 403
categories:
  - Article
tags:
  - javascript
  - JSOM
  - Office 365
  - Search
  - SharePoint 2013
date: 2015-07-01 09:22:51
featuredImage: 
  url: featured.jpg
  width: auto
  height: auto
---

## Introduction
With **SharePoint 2013**, the search capabilities are heavily invested in and we see a lot of **new JavaScript files** in our pages. For example, in term of `Search Result Pages`, we have a lot of JavaScript files and functions.

The goal of this post is to have like a **API reference** about these **Search JS** files. It is annoying to have to go over the files every time we need to remember some which classes we have inside. Later on this post we will go further with Refinement Web Part explaining some of the core classes and functions the have available.

This could give us the possibility to reuse some functions in **our custom JavaScript solutions**.

## Path
If you go to Layouts folder `C:\Program Files\Common Files\microsoft shared\Web Server Extensions\15\TEMPLATE\LAYOUTS` you can find these files:

![clip_image0034](./clip_image0034.png)

![clip_image0014](./clip_image0014.png)

![clip_image0024](./clip_image0024.png)

## Reference tables
This **table** will compile all the js **file descriptions**, **namespaces** and **classes**. That is intended to use as a reference instead to have to open all the JS files each time we need to investigate something.

|File|Namespaces|Classes|Description|
|:---|:--------|:-------|:-----|
|SP<br>.Search<br>.js|Microsoft<br>.SharePoint<br>.Client<br>.Search<br>.Query||Provide JSOM main to use JavaScript to Query the index. Some examples here:<br>[Combining Results in Hybrid env - COB](http://www.sharepointnutsandbolts.com/2014/05/office-365-sharepoint-hybrid-combining-results.html)<br>[Query Search with CSOM](http://www.dotnetmafia.com/blogs/dotnettipoftheday/archive/2013/04/18/how-to-query-search-with-the-sharepoint-2013-javascript-client-object-model.aspx)|
|Search<br>.Configuration<br>.js|Search<br>.Configuration|CatalogItemPicker<br>ContentBySearch<br>QueryBuilderUtility<br>CustomTab<br>RefinerTab<br>QueryBuilder<br>TokenExpansionData<br>QueryTemplateProperty<br>QueryBuilderResultSourceData<br>QueryBuilderConfigData<br>QueryBuilderState<br>SettingsTab<br>Refinement<br>SortTab<br>TestQueryTab|Provide JavaScript to deal with Search Configuration: ContentBySearch, Query Builder,…|
|search<br>.faceted<br>.navigation<br>.tab<br>.js|Microsoft<br>.SharePoint<br>.Search<br>.FacetedNavigation|TermInfo<br>TermDescendantsInfo<br>TermRefinementInfo<br>TermRefinementInfoWebServiceResult<br>TermDescendantsInfoWebServiceResult<br>FacetedNavigationTab|JavaScript engine for Managed Metadata Navigation in SharePoint 2013|
|Search.js|||Sounds like a mix between old format JavaScript and FAST integration. But I don't really know what is intended for.|
|search<br>.refinement<br>.configuration<br>.js|Microsoft<br>.SharePoint<br>.Search<br>.FacetedNavigation|RefinementConfigurationDialogArgs<br>RefinementConfiguration<br>RefinerConfiguration<br>RefinerConfigurationUIUtilities<br>ContextDataProviderState|Provide JavaScript functionality for Refinement Configuration page showed when Click on Show Refiners in the Refinement Web Part configuration pane.|
|search<br>.refinement<br>.configuration<br>.dialog<br>.js|Microsoft<br>.SharePoint<br>.Search<br>.FacetedNavigation|ManagedPropertyDescriptor<br>RefinementWebPartController<br>RefinementPreviewPopupDialogArgs<br>RefinementPreviewPopup<br>RefinementConfigurationDialog|Provide JavaScript functionality for the UI of Refinement configuration screen.|
|SearchUI<br>.js|Srch|Srch.SU<br>Srch.CU<br>Srch.PSU<br>Srch.SiteSearchUtil<br>Srch.SSU|It provides common javascript ui functions and definitions, like div ids, guids, image url constants, OOTB field names,…|
|search<br>.CBS<br>.js|Srch|ContentBySearch|JavaScript engine to deal with UI, Display Templates, … for Content By Search Web Part.|
|search<br>.taxonomy<br>.refinement<br>.js|Srch|TaxonomyRefinement<br>TaxonomyRefinementNodeInfo<br>TaxonomyNodeSearchResult|Provide the JavaScript engine to deal with Taxonomy Refiners with methods like `get_taxonomyRefinerName`, `get_currentTaxonomyNodes`, `get_renderCounts`, `get_itemTemplateId`, …|
|Search<br>.ClientControls<br>.js|Srch|Srch.EventType<br>Srch.MessageLevel<br>Srch.UserActionType<br>Srch.DateTimeKind<br>Srch.ClientControl<br>Srch.DataProvider<br>Srch.DisplayControl<br>Srch.Refinement<br>Srch.Result<br>Srch.SearchBox<br>Srch.U<br>Srch.U.PropNames<br>Srch.U.Ids<br>Srch.U.LoadScriptsState<br>Srch.ListenedEvent<br>Srch.ScriptApplicationManager<br>Srch.QueryGroup<br>Srch.LanguagePreference<br>Srch.QueryState<br>Srch.RefinementControl<br>Srch.RefinementCategory<br>Srch.DefaultQueryProperties<br>Srch.ResultSort<br>Srch.RankRule<br>Srch.ComplexResultSort<br>Srch.ControlMessage<br>Srch.PagingLink<br>Srch.ResultEventArgs<br>Srch.BatchResultEventArgs<br>Srch.QueryEventArgs<br>Srch.NavigationNode<br>Srch.ClickRecorder<br>Srch.RefinementUtil<br>Srch.ValueInfo<br>Srch.ValueInfo.Parsers<br>Srch.ValueInfo.Renderers<br>Srch.ValueInfo.ValueTypeHandler<br>Srch.ParseJSONUtil<br>Srch.DataConvertUtil|Provides the JavaScript engine (prototypes, functions, …) to deal with Filters, Display Templates, Paging, … inside Search Results, Search Box and Refinement WebPart|


Specifically, we will see in detail the **Classes** needed to understand the `Refinement Web Part` JavaScript client processing. IN the above table we have in bold all the classes that will be explained in the below table:

|**Class**|**Important Methods**|**Description**|
|:---|:---|:---|
|Srch.DataProvider|get_currentQueryState<br>get_sourceID<br>get_sourceName<br>get_queryGroupName<br>get_rankRules<br>get_initialQueryState<br>set_initialQueryState<br>get_selectedRefiners<br>set_selectedRefiners<br>get_totalRows<br>get_rowCount<br>get_refinementInfo<br>get_resultsUrl<br>set_resultsUrl<br>get_upScopeUrl<br>get_effectiveQueryLanguage<br>raiseQueryIssuingEvent<br>raiseResultReadyEvent<br>add_queryStateChanged<br>remove_queryStateChanged<br>raiseQueryStateChangedEvent<br>getSortRankName<br>getSortName|This is the data collector (controller). This Object keeps information about Search Box, Refiners, Results, paging and so more. This is intended to provide data when page status changes in the Search Page.<br>For example, if some results require paging, or require a batch query issuing. When a new query is requested using Search Box, this object can get the information from Search index asynchronousically.|
|Srch.DisplayControl|get_queryGroupName<br>set_queryGroupName<br>get_dataProvider<br>get_renderedResult<br>get_currentResultTableCollection<br>scriptApplication_PreLoad<br>add_queryReady<br>dataProvider_QueryIssuing<br>dataProvider_ResultReady<br>refresh<br>render|This is the Search Results Web Part manager (model). It is on charge of manage all the process of calling data provider, be sure data provider is on the most updated status and call the render (control and items display templates).|
|ScriptApplicationManager|get_current()<br>get_clientRuntimeContext()<br>get_preferencesUrl<br>get_displayTemplatesUrl<br>get_queryRulesUrl<br>get_resultSourcesUrl<br>get_userAdvancedLanguageSettingsUrl<br>get_pagePath<br>add_preLoad(value)<br>remove_preLoad(value)<br>raisePreLoadEvent()<br>add_load(value)<br>remove_load(value)<br>raiseLoadEvent()<br>add_postLoad(value)<br>remove_postLoad(value)<br>raisePostLoadEvent<br>getUserPreferenceLanguages<br>getAllSupportedLanguages<br>getNavigationNodes<br>getDisplayNameByLanguageID(lcid)<br>registerClientControl(cc)<br>navigateTo(url, fullNavigate)|This is on charge of manage all the Scripts added, removed, registered and updated inside the overall Search Results Page.<br>It is used to register controls, register display templates, navigate to other views without losing the script context, …|
|Srch.Refinement|createRefinementTextbox<br>submitMultiRefinement<br>getRefinementLocalizedTitle<br>getRefinementTitle<br>getExpanded<br>setExpanded<br>multiRefinerSpecifyOtherFilterValue<br>get_selectedRefinementControls<br>set_selectedRefinementControls<br>get_useManagedNavigationRefiners<br>set_useManagedNavigationRefiners<br>addRefinementFilter<br>addRefinementFiltersJSON<br>addRefinementFiltersJSONWithOr<br>addRefinementFilters<br>addRefinementFiltersWithOp<br>removeRefinementFilter<br>removeRefinementFiltersJSON<br>removeRefinementFilters<br>updateRefinementFilters<br>updateRefinersJSON<br>updateRefiners<br>removeRefinementCategory<br>replaceRefinementFilter<br>hasRefinementFilter<br>hasAllRefinementFilters<br>hasRefinementCategory<br>getCurrentRefinementCategory<br>getRefinementControl<br>hasRefiner<br>updateRefinementControls|This is the Refinement Web Part manager. It is on charge of manage all the filters and communicate them with the Search Results Web Part.<br>It uses Srch.QueryState object to maintain the consistency between the URL Query filters and the internal status in the Search JavaScript engine (browser memory).<br>As you can see on the right column, it has a lot of methods to add, remove or update refiner filters.<br>For a detailed view of every method you can visit: [Elio's post](http://www.eliostruyf.com/part-5-search-refiner-control-methods-explained/)|
|Srch.QueryState|Srch.QueryState.prototype = {<br>k: '', // Keyword<br>o: null, // Sort Orders<br>s: 0, // Start At<br>r: null, // Refiners (RefinementCategory object)<br>l: 0, // Query Language<br>m: '', // Ranking Model ID<br>d: 0, // Trim Duplicates Include ID<br>x: null, // Rank Rules<br>….<br>}|Tracks transient search query properties that can be changed by a regular searcher and need to be persisted in url bookmarks.<br>Similar to this one: [MSDN](https://msdn.microsoft.com/EN-US/library/office/microsoft.office.server.search.webcontrols.querystate.aspx)|
|Srch.RefinementControl|Srch_RefinementControl(propertyName, spec, renderTemplateId)<br>Srch.RefinementControl.prototype = {<br>propertyName: null,<br>spec: null,<br>renderTemplateId: '4',<br>overrideDisplayName: null,<br>useDefaultDateIntervals: false,<br>containerId: null,<br>alternateRenderer: null,<br>alternateRenderContext: null,<br>countDisplay: 'Both'<br>}|Represents a search result property bound to a refinement filter control.<br>Similar to this: [MSDN](https://msdn.microsoft.com/EN-US/library/office/microsoft.office.server.search.webcontrols.refinementcontrol_members.aspx)|
|Srch.RefinementCategory|Srch_RefinementCategory(refinementName)<br>Srch.RefinementCategory.prototype = {<br>n: null,<br>t: null,<br>o: 'and',<br>k: false,<br>m: null,<br>get_tokenCount<br>addToken (refinementToken)<br>removeToken (refinementToken)<br>hasToken(refinementToken)<br>…<br>}|Represents a refinement category that consists of a refinement name and a list of refinement tokens.<br>n: refiner name;<br>t: refiner tokens;<br>o: operator (and, or);<br>k: use KQL (Boolean);<br>m: this is the token to display value map. It's used when a custom refinement value (textbox) is used. This stores the value that you inserted, to visualize it in the refiner. Example: "m":{"equals(\"Item Value Text Box\")":"Item Value Text Box"}<br>Via: [Elio Struyf - Post](http://www.eliostruyf.com/part-5-search-refiner-control-methods-explained/)|
|Srch.U|isPageInEditMode<br>isPageInMdsMode<br>isPagePartialLoad<br>ensureNotNullOrUndefined(value, context, methodName, paraName)<br>ensureNotNullOrEmptyString(value, context, methodName, paraName)<br>isArray (obj)<br>appendArray (a, item)<br>trimExtraSpaces (text)<br>ensureCSSClassNameExist (e, className)<br>setCookie (name, value, expires, domain, path)<br>getCookie (name)<br>getHostName<br>trace (c, method, message)<br>encodeUrlForHtmlAttributes (url)<br>getUsernameFromAuthorField (authorField)<br>isWebPage (fileExtension)<br>truncateEnd (original, maxChars)<br>toFormattedDate (dateValue, dateTimeFormatId)<br>toFileSizeDisplay (numberOfBytes, showDecimalPart)<br>registerRenderTemplateByName (name, template)<br>getRenderTemplateCollection()<br>getRenderTemplateByName (name, renderCtx)<br>getFormattedTimeFromSeconds (secondsStr)<br>resolveRenderTemplate (renderCtx, component, level)<br>trimTitle (title, maximumLengthInChars, numberOfTermsToUse)<br>hideElement (element)<br>showElement (element)<br>loadScripts (scriptReferences, success, failure, timeout)<br>appendScriptsToLoad (scripts, script)<br>registerLoadedScripts (scripts)<br>collapsibleRefinerTitle(propertyName, idPrefix, title, iconClass, customOnClick)<br>isDefaultSiteSearchPage<br>includeCSS (templateLink, relativeLink)<br>includeScript (templateLink, scriptLink)<br>includeLanguageScript (templateLink, scriptLink)<br>loadResource (id)<br>loadResourceForTemplate (id, templateFunc)<br>registerResourceDictionary (locale, dict)|The Srch.Uobject provides a range of JavaScript methods and enumerations to help you in your work with display templates customization in SharePoint 2013:<br>Srch.U object (DisplayTemplatesSrch):<br>[MSDN](https://msdn.microsoft.com/en-us/library/office/dn768292.aspx)<br>[Display Templates - DotnetMafia](http://www.dotnetmafia.com/blogs/dotnettipoftheday/archive/2014/02/26/useful-javascript-for-working-with-sharepoint-display-templates-spc3000-spc14.aspx)|
|Srch.RefinementUtil|peoplePickerApplyIdPrefix(ctrl)<br>peoplePickerPrep(pickerId, ctrl, cliCtrl)<br>refineByAuthor(pickerId, filterToken)<br>authorRefinerResolved(controlID, pickerValue)<br>escapeTokenStringValue(tokenValue)|Refiners utilities almost all to manage people picker and user field.|
