<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Accept-CH" content="DPR, Viewport-Width, Width"><title>How to attach an event receiver for an specific list in SharePoint 2013 | José Quinto</title><meta name="description" content="How to attach an event receiver for an specific list in SharePoint 2013"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover"><meta property="og:image" content="https://blog.josequinto.com/2014/11/06/how-to-attach-an-event-receiver-for-an-specific-list-in-sharepoint-2013/featured.png"><meta name="twitter:image" content="https://blog.josequinto.com/2014/11/06/how-to-attach-an-event-receiver-for-an-specific-list-in-sharepoint-2013/featured.png"><meta property="fb:app_id" content="155567495101835"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:url" content="https://blog.josequinto.com/2014/11/06/how-to-attach-an-event-receiver-for-an-specific-list-in-sharepoint-2013/" property="og:url"><meta name="twitter:title" content="How to attach an event receiver for an specific list in SharePoint 2013 | José Quinto" property="og:title"><meta name="twitter:site" content="@jquintozamora"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.josequinto.com/2014/11/06/how-to-attach-an-event-receiver-for-an-specific-list-in-sharepoint-2013/"><meta property="og:title" content="How to attach an event receiver for an specific list in SharePoint 2013 | José Quinto"><link rel="canonical" href="https://blog.josequinto.com/2014/11/06/how-to-attach-an-event-receiver-for-an-specific-list-in-sharepoint-2013/"><link rel="author" href="https://plus.google.com/u/0/108403117712061507579"><link rel="alternate" type="application/rss+xml" title="Jose Quinto" href="https://blog.josequinto.com/feed.rss"><meta name="theme-color" content="#ffffff"><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.1"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.3/dist/instantsearch.min.js" defer></script><script>var GLOBAL = { 
  root: '/',
  algolia: {"appId":"C7MOFESP3V","apiKey":"cdc4a9b7af864c710f2d3da5caf59eec","indexName":"dev_JQBLOG","hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><div id="bodyWrapper"><div id="content-outer"><div id="top-container" style="background-image: url(/background.svg)"><div id="page-header"><span class="pull-left"> <a class="brand" href="/"><img class="brand-image" src="/jose-quinto.png"><div class="brand-name">José Quinto</div></a></span><i class="fa fa-share toggle-social" aria-hidden="true"></i><div class="socialicons" id="header-social-icons"><a class="social-icon" href="https://twitter.com/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-twitter"></i></a><a class="social-icon" href="https://github.com/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-github"></i></a><a class="social-icon" href="https://codepen.io/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-codepen"></i></a><a class="social-icon" href="https://www.linkedin.com/in/jquintozamora" target="_blank" rel="noopener"><i class="fa fa-linkedin"></i></a><a class="social-icon" href="https://stackoverflow.com/users/5015774/jos%C3%A9-quinto-zamora?tab=profile" target="_blank" rel="noopener"><i class="fa fa-stack-overflow"></i></a><a class="social-icon" href="https://blog.josequinto.com/feed.rss" target="_blank" rel="noopener"><i class="fa fa-rss"></i></a></div><a class="social-icon search"><i class="fa fa-search"></i></a><div class="search-dialog" id="algolia-search"><div class="search-dialog__title" id="algolia-search-title">Search posts:</div><div id="algolia-input-panel"><div id="algolia-search-input"></div></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-stats"></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/about.html">About</a></span></div><div id="post-info"><div id="post-title">How to attach an event receiver for an specific list in SharePoint 2013</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2014-11-06</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/taxonomy/Code-Reminder/">Code-Reminder</a><span class="post-meta__separator">|</span><i class="fa fa-comment-o post-meta__icon" aria-hidden="true"></i><a href="/2014/11/06/how-to-attach-an-event-receiver-for-an-specific-list-in-sharepoint-2013/#disqus_thread"><span class="disqus-comment-count" data-disqus-identifier="2014/11/06/how-to-attach-an-event-receiver-for-an-specific-list-in-sharepoint-2013/"></span></a></div></div></div><div class="layout" id="content-inner"><section class="articlePostContainer"><nav class="sidebar-toc"><div class="sidebar-toc__title">Contents</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Event-Receiver-parameters"><span class="toc-number">2.</span> <span class="toc-text">Event Receiver parameters</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Create-event-receiver"><span class="toc-number">3.</span> <span class="toc-text">Create event receiver</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Results"><span class="toc-number">4.</span> <span class="toc-text">Results</span></a></li></ol></div></nav><section class="postArticle"><article id="post"><div class="post-featuredImage"><img src="featured.png" width="auto" height="auto"></div><div id="post-content"><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>In <strong>SharePoint</strong> we can use event receivers to trigger events like adding, updating, deleting elements from a list. When we need to do some extra tasks it is really useful and straightforward method.</p>
<p>I’d like to explain what happens behind scenes when we are creating <code>Event Receiver</code> project in <em>Visual Studio</em>. </p>
<p>In this case I will use <strong>Visual Studio 2013</strong> and <strong>SharePoint 2013</strong>.</p>
<h2 id="Event-Receiver-parameters"><a href="#Event-Receiver-parameters" class="headerlink" title="Event Receiver parameters"></a>Event Receiver parameters</h2><p>First of all, we need to define the Event Receiver parameters:</p>
<ul>
<li><strong>Scope</strong>: only one List (Lists/PublishedFeed)</li>
<li><strong>Activation Scope</strong>: using a Web-scoped Feature </li>
<li><strong>Type</strong>: ItemAdded (complete list <a href="http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.speventreceivertype.aspx" target="_blank" rel="noopener">here</a>)</li>
<li><strong>Execution Stage</strong>: first add the item, later execute my code – so, ItemAdded instead ItemAdding</li>
</ul>
<h2 id="Create-event-receiver"><a href="#Create-event-receiver" class="headerlink" title="Create event receiver"></a>Create event receiver</h2><p>Now we can follow this procedure for creating the Event Receiver:</p>
<ol>
<li><p>Create New Project in Visual Studio of type “SharePoint 2013 – Empty Project”</p>
<blockquote>
<p><img src="./image.png" alt="image"> </p>
</blockquote>
</li>
<li><p>Add new item of type “Event Receiver”</p>
<blockquote>
<p><img src="./image1.png" alt="image"> </p>
</blockquote>
</li>
<li><p>Rename Feature to give its more friendly name and define scope to Web</p>
<blockquote>
<p><img src="./image2.png" alt="image">   </p>
</blockquote>
</li>
<li><p>Edit Elements.xml file </p>
<blockquote>
<p>You will notice that there is Receivers element with <strong> ListTemplateId=”100”</strong> (or similar depends on the list type you chose when created Event Receiver)
It is important to know that if you deploy this feature with this Event Receiver it will be deployed on all “Custom Lists”. </p>
</blockquote>
<p>Our scope is to have only in one list so we will update with that:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Elements</span> <span class="attr">xmlns</span>=<span class="string">"http://schemas.microsoft.com/sharepoint/"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Receivers</span> <span class="attr">ListUrl</span>=<span class="string">"Lists/PublishedFeed"</span> &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">Receiver</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Name</span>&gt;</span>NewsfeedNotificationItemAdded<span class="tag">&lt;/<span class="name">Name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Type</span>&gt;</span>ItemAdded<span class="tag">&lt;/<span class="name">Type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Assembly</span>&gt;</span>$SharePoint.Project.AssemblyFullName$<span class="tag">&lt;/<span class="name">Assembly</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Class</span>&gt;</span>NewsfeedEventReceiver.NewsfeedNotification.NewsfeedNotification<span class="tag">&lt;/<span class="name">Class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">SequenceNumber</span>&gt;</span>10000<span class="tag">&lt;/<span class="name">SequenceNumber</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">Receiver</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Receivers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Elements</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>IMPORTANT to put ListUrl in order to scope the activation of this event receiver only to this list.</strong></p>
</blockquote>
</li>
<li><p>Edit .cs to create your custom code</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">NewsfeedEventReceiver.NewsfeedNotification</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> List Item Events</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">NewsfeedNotification</span> : <span class="title">SPItemEventReceiver</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> An item was added.</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">ItemAdded</span>(<span class="params">SPItemEventProperties properties</span>)</span></span><br><span class="line"><span class="function"></span>        &#123;</span><br><span class="line">            <span class="keyword">base</span>.ItemAdded(properties);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">string</span> title = properties.ListItem.Title;</span><br><span class="line">            <span class="keyword">string</span> content = properties.ListItem[<span class="string">"SearchContent"</span>].ToString();</span><br><span class="line"></span><br><span class="line">            SPDiagnosticsService diagSvc = SPDiagnosticsService.Local;</span><br><span class="line">            diagSvc.WriteTrace(<span class="number">0</span>, <span class="keyword">new</span> SPDiagnosticsCategory(<span class="string">"Newsfeed Notification"</span>, TraceSeverity.Monitorable, EventSeverity.Information),</span><br><span class="line">                    TraceSeverity.Monitorable, <span class="string">"Writing to the ULS log:  &#123;0&#125;"</span>, <span class="keyword">new</span> <span class="keyword">object</span>[] &#123; title + <span class="string">": "</span> + content &#125;);   </span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Deploy the solution in SharePoint
That will activate the feature and the feature activation process automatically will attach the event receiver to the list.</p>
<blockquote>
<p><strong>Note: If you deactivate the feature the event receiver will be removed from the list too.</strong></p>
</blockquote>
</li>
<li><p>Test Event Receiver
We can use this PowerShell to check that Event Receiver is attached.</p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$spWeb</span> = Get-SPWeb http://site;</span><br><span class="line"><span class="variable">$spList</span> = <span class="variable">$spWeb</span>.Lists[<span class="string">"MicroFeed"</span>];</span><br><span class="line"><span class="variable">$spList</span>.EventReceivers | Select Name, Assembly, Type;</span><br></pre></td></tr></table></figure>
<h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><p>So, if the feature is disabled:
<img src="./image3.png" alt="image"></p>
<p>We will have these OOB event receivers:
<img src="./image4.png" alt="image"></p>
<p>&nbsp;
And if the feature is enabled:
<img src="./image5.png" alt="image"></p>
<p>We will have our own event receiver too:
<img src="./image6.png" alt="image"></p>
</div><div id="post-content-bottom-space"><p>&nbsp;</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://twitter.com/jquintozamora" target="_blank">José Quinto</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://blog.josequinto.com/2014/11/06/how-to-attach-an-event-receiver-for-an-specific-list-in-sharepoint-2013/">https://blog.josequinto.com/2014/11/06/how-to-attach-an-event-receiver-for-an-specific-list-in-sharepoint-2013/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/category/SharePoint-2013/">SharePoint 2013</a><a class="post-meta__tags" href="/category/SharePoint/">SharePoint</a><a class="post-meta__tags" href="/category/event-receiver/">event receiver</a><a class="post-meta__tags" href="/category/PowerShell/">PowerShell</a><a class="post-meta__tags" href="/category/SharePoint-2010/">SharePoint 2010</a></div></article><nav id="pagination"><div class="prev-post pull-left"><a href="/2014/11/24/change-site-contents-style-in-sharepoint-2013/" title="previous page"><i class="fa fa-chevron-left" aria-hidden="true"></i><span>Change Site Contents Style in SharePoint 2013</span></a></div><div class="next-post pull-right"><a href="/2014/08/04/diseo-de-menu-nav-bar-con-css-en-sharepoint-2013/" title="next page"><span>Three level CSS Navigation Menu for SharePoint 2013</span><i class="fa fa-chevron-right" aria-hidden="true"></i></a></div></nav><div id="disqus_thread"></div><script>var disqus_config = function () {
  this.page.url = 'https://blog.josequinto.com/2014/11/06/how-to-attach-an-event-receiver-for-an-specific-list-in-sharepoint-2013/';
  this.page.identifier = '298';
  this.page.title = 'How to attach an event receiver for an specific list in SharePoint 2013';
}
var d = document, s = d.createElement('script');
s.src = "https://https-blog-josequinto-com.disqus.com/embed.js";
s.setAttribute('data-timestamp', '' + +new Date());
(d.head || d.body).appendChild(s);</script><script id="dsq-count-src" src="//https-blog-josequinto-com.disqus.com/count.js" async></script></section></section></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2022 By José Quinto</div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i></div><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.1"></script><script src="/js/fancybox.js?version=1.5.1"></script><script src="/js/copy.js?version=1.5.1"></script><script src="/js/scroll.js?version=1.5.1"></script><script src="/js/head.js?version=1.5.1"></script><script src="/js/search/algolia.js"></script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-44570510-1', 'auto');
ga('send', 'pageview');</script><script async src="https://www.google-analytics.com/analytics.js"></script><link rel="manifest" href="/manifest.json"><script async src="/js/registerServiceWorker.js"></script></body></html>